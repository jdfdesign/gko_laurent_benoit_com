/* ===================================================
 * bootstrap-transition.js v2.0.4
 * http://twitter.github.com/bootstrap/javascript.html#transitions
 * ===================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================== */
!function(t){t(function(){"use strict";t.support.transition=function(){var t=function(){var t,e=document.createElement("bootstrap"),i={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"};for(t in i)if(void 0!==e.style[t])return i[t]}();return t&&{end:t}}()})}(window.jQuery),/* ==========================================================
 * bootstrap-alert.js v2.0.4
 * http://twitter.github.com/bootstrap/javascript.html#alerts
 * ==========================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================== */
!function(t){"use strict";var e='[data-dismiss="alert"]',i=function(i){t(i).on("click",e,this.close)};i.prototype.close=function(e){function i(){n.trigger("closed").remove()}var n,o=t(this),s=o.attr("data-target");s||(s=o.attr("href"),s=s&&s.replace(/.*(?=#[^\s]*$)/,"")),n=t(s),e&&e.preventDefault(),n.length||(n=o.hasClass("alert")?o:o.parent()),n.trigger(e=t.Event("close")),e.isDefaultPrevented()||(n.removeClass("in"),t.support.transition&&n.hasClass("fade")?n.on(t.support.transition.end,i):i())},t.fn.alert=function(e){return this.each(function(){var n=t(this),o=n.data("alert");o||n.data("alert",o=new i(this)),"string"==typeof e&&o[e].call(n)})},t.fn.alert.Constructor=i,t(function(){t("body").on("click.alert.data-api",e,i.prototype.close)})}(window.jQuery),/* ============================================================
 * bootstrap-button.js v2.0.4
 * http://twitter.github.com/bootstrap/javascript.html#buttons
 * ============================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ============================================================ */
!function(t){"use strict";var e=function(e,i){this.$element=t(e),this.options=t.extend({},t.fn.button.defaults,i)};e.prototype.setState=function(t){var e="disabled",i=this.$element,n=i.data(),o=i.is("input")?"val":"html";t+="Text",n.resetText||i.data("resetText",i[o]()),i[o](n[t]||this.options[t]),setTimeout(function(){"loadingText"==t?i.addClass(e).attr(e,e):i.removeClass(e).removeAttr(e)},0)},e.prototype.toggle=function(){var t=this.$element.parent('[data-toggle="buttons-radio"]');t&&t.find(".active").removeClass("active"),this.$element.toggleClass("active")},t.fn.button=function(i){return this.each(function(){var n=t(this),o=n.data("button"),s="object"==typeof i&&i;o||n.data("button",o=new e(this,s)),"toggle"==i?o.toggle():i&&o.setState(i)})},t.fn.button.defaults={loadingText:"loading..."},t.fn.button.Constructor=e,t(function(){t("body").on("click.button.data-api","[data-toggle^=button]",function(e){var i=t(e.target);i.hasClass("btn")||(i=i.closest(".btn")),i.button("toggle")})})}(window.jQuery),/* =============================================================
 * bootstrap-collapse.js v2.0.4
 * http://twitter.github.com/bootstrap/javascript.html#collapse
 * =============================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ============================================================ */
!function(t){"use strict";var e=function(e,i){this.$element=t(e),this.options=t.extend({},t.fn.collapse.defaults,i),this.options.parent&&(this.$parent=t(this.options.parent)),this.options.toggle&&this.toggle()};e.prototype={constructor:e,dimension:function(){var t=this.$element.hasClass("width");return t?"width":"height"},show:function(){var e,i,n,o;if(!this.transitioning){if(e=this.dimension(),i=t.camelCase(["scroll",e].join("-")),n=this.$parent&&this.$parent.find("> .accordion-group > .in"),n&&n.length){if(o=n.data("collapse"),o&&o.transitioning)return;n.collapse("hide"),o||n.data("collapse",null)}this.$element[e](0),this.transition("addClass",t.Event("show"),"shown"),this.$element[e](this.$element[0][i])}},hide:function(){var e;this.transitioning||(e=this.dimension(),this.reset(this.$element[e]()),this.transition("removeClass",t.Event("hide"),"hidden"),this.$element[e](0))},reset:function(t){var e=this.dimension();return this.$element.removeClass("collapse")[e](t||"auto")[0].offsetWidth,this.$element[null!==t?"addClass":"removeClass"]("collapse"),this},transition:function(e,i,n){var o=this,s=function(){"show"==i.type&&o.reset(),o.transitioning=0,o.$element.trigger(n)};this.$element.trigger(i),i.isDefaultPrevented()||(this.transitioning=1,this.$element[e]("in"),t.support.transition&&this.$element.hasClass("collapse")?this.$element.one(t.support.transition.end,s):s())},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}},t.fn.collapse=function(i){return this.each(function(){var n=t(this),o=n.data("collapse"),s="object"==typeof i&&i;o||n.data("collapse",o=new e(this,s)),"string"==typeof i&&o[i]()})},t.fn.collapse.defaults={toggle:!0},t.fn.collapse.Constructor=e,t(function(){t("body").on("click.collapse.data-api","[data-toggle=collapse]",function(e){var i,n=t(this),o=n.attr("data-target")||e.preventDefault()||(i=n.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,""),s=t(o).data("collapse")?"toggle":n.data();t(o).collapse(s)})})}(window.jQuery),/* ============================================================
 * bootstrap-dropdown.js v2.0.4
 * http://twitter.github.com/bootstrap/javascript.html#dropdowns
 * ============================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ============================================================ */
!function(t){"use strict";function e(){t(i).parent().removeClass("open")}var i='[data-toggle="dropdown"]',n=function(e){var i=t(e).on("click.dropdown.data-api",this.toggle);t("html").on("click.dropdown.data-api",function(){i.parent().removeClass("open")})};n.prototype={constructor:n,toggle:function(){var i,n,o,s=t(this);if(!s.is(".disabled, :disabled"))return n=s.attr("data-target"),n||(n=s.attr("href"),n=n&&n.replace(/.*(?=#[^\s]*$)/,"")),i=t(n),i.length||(i=s.parent()),o=i.hasClass("open"),e(),o||i.toggleClass("open"),!1}},t.fn.dropdown=function(e){return this.each(function(){var i=t(this),o=i.data("dropdown");o||i.data("dropdown",o=new n(this)),"string"==typeof e&&o[e].call(i)})},t.fn.dropdown.Constructor=n,t(function(){t("html").on("click.dropdown.data-api",e),t("body").on("click.dropdown",".dropdown form",function(t){t.stopPropagation()}).on("click.dropdown.data-api",i,n.prototype.toggle)})}(window.jQuery),function(t){var e,i=this,n=i.document,o=t(n),s=t(i),a=Array.prototype,r=1.28,l=!0,h=3e4,c=!1,u=navigator.userAgent.toLowerCase(),d=i.location.hash.replace(/#\//,""),p=function(){},g=function(){return!1},m=function(){var t=3,i=n.createElement("div"),o=i.getElementsByTagName("i");do i.innerHTML="<!--[if gt IE "+ ++t+"]><i></i><![endif]-->";while(o[0]);return t>4?t:e}(),f=function(){return{html:n.documentElement,body:n.body,head:n.getElementsByTagName("head")[0],title:n.title}},v="data ready thumbnail loadstart loadfinish image play pause progress fullscreen_enter fullscreen_exit idle_enter idle_exit rescale lightbox_open lightbox_close lightbox_image",y=function(){var e=[];return t.each(v.split(" "),function(t,i){e.push(i),/_/.test(i)&&e.push(i.replace(/_/g,""))}),e}(),w=function(e){var i;return"object"!=typeof e?e:(t.each(e,function(n,o){/^[a-z]+_/.test(n)&&(i="",t.each(n.split("_"),function(t,e){i+=t>0?e.substr(0,1).toUpperCase()+e.substr(1):e}),e[i]=o,delete e[n])}),e)},b=function(e){return t.inArray(e,y)>-1?Galleria[e.toUpperCase()]:e},T={youtube:{reg:/https?:\/\/(?:[a-zA_Z]{2,3}.)?(?:youtube\.com\/watch\?)((?:[\w\d\-\_\=]+&amp;(?:amp;)?)*v(?:&lt;[A-Z]+&gt;)?=([0-9a-zA-Z\-\_]+))/i,embed:function(t){return"http://www.youtube.com/embed/"+t},getThumb:function(e,i,n){n=n||p,t.getJSON("http://gdata.youtube.com/feeds/api/videos/"+e+"?v=2&alt=json-in-script&callback=?",function(t){try{i(t.entry.media$group.media$thumbnail[0].url)}catch(e){n()}}).error(n)}},vimeo:{reg:/https?:\/\/(?:www\.)?(vimeo\.com)\/(?:hd#)?([0-9]+)/i,embed:function(t){return"http://player.vimeo.com/video/"+t},getThumb:function(e,i,n){n=n||p,t.getJSON("http://vimeo.com/api/v2/video/"+e+".json?callback=?",function(t){try{i(t[0].thumbnail_medium)}catch(e){n()}}).error(n)}},dailymotion:{reg:/https?:\/\/(?:www\.)?(dailymotion\.com)\/video\/([^_]+)/,embed:function(t){return"http://www.dailymotion.com/embed/video/"+t},getThumb:function(e,i,n){n=n||p,t.getJSON("https://api.dailymotion.com/video/"+e+"?fields=thumbnail_medium_url&callback=?",function(t){try{i(t.thumbnail_medium_url)}catch(e){n()}}).error(n)}}},E=function(t){var e;for(var i in T)if(e=t&&t.match(T[i].reg),e&&e.length)return{id:e[2],provider:i};return!1},S={support:function(){var t=f().html;return t.requestFullscreen||t.mozRequestFullScreen||t.webkitRequestFullScreen}(),callback:p,enter:function(t,e){this.instance=t,this.callback=e||p;var i=f().html;i.requestFullscreen?i.requestFullscreen():i.mozRequestFullScreen?i.mozRequestFullScreen():i.webkitRequestFullScreen&&i.webkitRequestFullScreen()},exit:function(t){this.callback=t||p,n.exitFullscreen?n.exitFullscreen():n.mozCancelFullScreen?n.mozCancelFullScreen():n.webkitCancelFullScreen&&n.webkitCancelFullScreen()},instance:null,listen:function(){if(this.support){var t=function(){if(S.instance){var t=S.instance._fullscreen;n.fullscreen||n.mozFullScreen||n.webkitIsFullScreen?t._enter(S.callback):t._exit(S.callback)}};n.addEventListener("fullscreenchange",t,!1),n.addEventListener("mozfullscreenchange",t,!1),n.addEventListener("webkitfullscreenchange",t,!1)}}},C={trunk:{},add:function(t,e,n,o){if(t=t||(new Date).getTime(),o=o||!1,this.clear(t),o){var s=e;e=function(){s(),C.add(t,e,n)}}this.trunk[t]=i.setTimeout(e,n)},clear:function(t){var e,n=function(t){i.clearTimeout(this.trunk[t]),delete this.trunk[t]};if(t&&t in this.trunk)n.call(C,t);else if("undefined"==typeof t)for(e in this.trunk)this.trunk.hasOwnProperty(e)&&n.call(C,e)}},x=[],_=[],D=!1,O=!1,M=[],I=function(e){Galleria.theme=e,t.each(M,function(t,e){e._initialized||e._init.call(e)})},H=function(){return{array:function(t){return a.slice.call(t,0)},create:function(t,e){e=e||"div";var i=n.createElement(e);return i.className=t,i},getScriptPath:function(e){e=e||t("script:last").attr("src");var i=e.split("/");return 1==i.length?"":(i.pop(),i.join("/")+"/")},animate:function(){var e,o,s,a,r,l,h,c=function(t){var e,n="transition WebkitTransition MozTransition OTransition".split(" ");if(i.opera)return!1;for(e=0;n[e];e++)if("undefined"!=typeof t[n[e]])return n[e];return!1}((n.body||n.documentElement).style),u={MozTransition:"transitionend",OTransition:"oTransitionEnd",WebkitTransition:"webkitTransitionEnd",transition:"transitionend"}[c],d={_default:[.25,.1,.25,1],galleria:[.645,.045,.355,1],galleriaIn:[.55,.085,.68,.53],galleriaOut:[.25,.46,.45,.94],ease:[.25,0,.25,1],linear:[.25,.25,.75,.75],"ease-in":[.42,0,1,1],"ease-out":[0,0,.58,1],"ease-in-out":[.42,0,.58,1]},g=function(e,i,n){var o={};n=n||"transition",t.each("webkit moz ms o".split(" "),function(){o["-"+this+"-"+n]=i}),e.css(o)},m=function(t){g(t,"none","transition"),Galleria.WEBKIT&&Galleria.TOUCH&&(g(t,"translate3d(0,0,0)","transform"),t.data("revert")&&(t.css(t.data("revert")),t.data("revert",null)))};return function(n,f,v){return v=t.extend({duration:400,complete:p,stop:!1},v),n=t(n),v.duration?c?(v.stop&&(n.unbind(u),m(n)),e=!1,t.each(f,function(t,i){h=n.css(t),H.parseValue(h)!=H.parseValue(i)&&(e=!0),n.css(t,h)}),e?(o=[],s=v.easing in d?d[v.easing]:d._default,a=" "+v.duration+"ms cubic-bezier("+s.join(",")+")",i.setTimeout(function(e,i,n,s){return function(){e.one(i,function(t){return function(){m(t),v.complete.call(t[0])}}(e)),Galleria.WEBKIT&&Galleria.TOUCH&&(r={},l=[0,0,0],t.each(["left","top"],function(t,i){i in n&&(l[t]=H.parseValue(n[i])-H.parseValue(e.css(i))+"px",r[i]=n[i],delete n[i])}),(l[0]||l[1])&&(e.data("revert",r),o.push("-webkit-transform"+s),g(e,"translate3d("+l.join(",")+")","transform"))),t.each(n,function(t){o.push(t+s)}),g(e,o.join(",")),e.css(n)}}(n,u,f,a),2),void 0):(i.setTimeout(function(){v.complete.call(n[0])},v.duration),void 0)):(n.animate(f,v),void 0):(n.css(f),v.complete.call(n[0]),void 0)}}(),removeAlpha:function(t){if(9>m&&t){var e=t.style,i=t.currentStyle,n=i&&i.filter||e.filter||"";/alpha/.test(n)&&(e.filter=n.replace(/alpha\([^)]*\)/i,""))}},forceStyles:function(e,i){e=t(e),e.attr("style")&&e.data("styles",e.attr("style")).removeAttr("style"),e.css(i)},revertStyles:function(){t.each(H.array(arguments),function(e,i){i=t(i),i.removeAttr("style"),i.attr("style",""),i.data("styles")&&i.attr("style",i.data("styles")).data("styles",null)})},moveOut:function(t){H.forceStyles(t,{position:"absolute",left:-1e4})},moveIn:function(){H.revertStyles.apply(H,H.array(arguments))},elem:function(e){return e instanceof t?{$:e,dom:e[0]}:{$:t(e),dom:e}},hide:function(t,e,i){i=i||p;var n=H.elem(t),o=n.$;t=n.dom,o.data("opacity")||o.data("opacity",o.css("opacity"));var s={opacity:0};if(e){var a=9>m&&t?function(){H.removeAlpha(t),t.style.visibility="hidden",i.call(t)}:i;H.animate(t,s,{duration:e,complete:a,stop:!0})}else 9>m&&t?(H.removeAlpha(t),t.style.visibility="hidden"):o.css(s)},show:function(t,e,i){i=i||p;var n=H.elem(t),o=n.$;t=n.dom;var s=parseFloat(o.data("opacity"))||1,a={opacity:s};if(e){9>m&&(o.css("opacity",0),t.style.visibility="visible");var r=9>m&&t?function(){1==a.opacity&&H.removeAlpha(t),i.call(t)}:i;H.animate(t,a,{duration:e,complete:r,stop:!0})}else 9>m&&1==a.opacity&&t?(H.removeAlpha(t),t.style.visibility="visible"):o.css(a)},optimizeTouch:function(){var e,i,n,o,s={},a=function(e){e.preventDefault(),s=t.extend({},e,!0)},r=function(){this.evt=s},l=function(){this.handler.call(e,this.evt)};return function(s){t(s).bind("touchend",function(s){for(e=s.target,o=!0;e.parentNode&&e!=s.currentTarget&&o;)i=t(e).data("events"),n=t(e).data("fakes"),i&&"click"in i?(o=!1,s.preventDefault(),t(e).click(a).click(),i.click.pop(),t.each(i.click,r),t(e).data("fakes",i.click),delete i.click):n&&(o=!1,s.preventDefault(),t.each(n,l)),e=e.parentNode})}}(),addTimer:function(){return C.add.apply(C,H.array(arguments)),this},clearTimer:function(){return C.clear.apply(C,H.array(arguments)),this},wait:function(e){e=t.extend({until:g,success:p,error:function(){Galleria.raise("Could not complete wait function.")},timeout:3e3},e);var n,o,s=H.timestamp(),a=function(){return o=H.timestamp(),n=o-s,e.until(n)?(e.success(),!1):"number"==typeof e.timeout&&o>=s+e.timeout?(e.error(),!1):(i.setTimeout(a,10),void 0)};i.setTimeout(a,10)},toggleQuality:function(t,e){7!==m&&8!==m||!t||"IMG"!=t.nodeName.toUpperCase()||("undefined"==typeof e&&(e="nearest-neighbor"===t.style.msInterpolationMode),t.style.msInterpolationMode=e?"bicubic":"nearest-neighbor")},insertStyleTag:function(t){var e=n.createElement("style");if(f().head.appendChild(e),e.styleSheet)e.styleSheet.cssText=t;else{var i=n.createTextNode(t);e.appendChild(i)}},loadScript:function(e,i){var n=!1,o=t("<script>").attr({src:e,async:!0}).get(0);o.onload=o.onreadystatechange=function(){n||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(n=!0,o.onload=o.onreadystatechange=null,"function"==typeof i&&i.call(this,this))},f().head.appendChild(o)},parseValue:function(t){if("number"==typeof t)return t;if("string"==typeof t){var e=t.match(/\-?\d|\./g);return e&&e.constructor===Array?1*e.join(""):0}return 0},timestamp:function(){return(new Date).getTime()},loadCSS:function(o,s,a){var r,l,h=!1,c=function(){var t=new Image;t.onload=t.onerror=function(){t=null,h=!0},t.src=o};return t("link[rel=stylesheet]").each(function(){return new RegExp(o).test(this.href)?(r=this,!1):void 0}),"function"==typeof s&&(a=s,s=e),a=a||p,r?(a.call(r,r),r):(l=n.styleSheets.length,t("#"+s).length?(t("#"+s).attr("href",o),l--,h=!0):(r=t("<link>").attr({rel:"stylesheet",href:o,id:s}).get(0),i.setTimeout(function(){var e=t('link[rel="stylesheet"], style');if(e.length?e.get(0).parentNode.insertBefore(r,e[0]):f().head.appendChild(r),m){if(l>=31)return Galleria.raise("You have reached the browser stylesheet limit (31)",!0),void 0;r.onreadystatechange=function(){h||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(h=!0)}}else{var s=n.createElement("a"),a=i.location;s.href=o,/file/.test(a.protocol)||a.hostname!=s.hostname||a.port!=s.port||a.protocol!=s.protocol?c():t.ajax({url:o,success:function(){h=!0},error:c})}},10)),"function"==typeof a&&H.wait({until:function(){return h&&n.styleSheets.length>l},success:function(){i.setTimeout(function(){a.call(r,r)},100)},error:function(){Galleria.raise("Theme CSS could not load",!0)},timeout:1e4}),r)}}}(),P=function(){var e=function(e,i,n,o){var s=this.getOptions("easing"),a=this.getStageWidth(),r={left:a*(e.rewind?-1:1)},l={left:0};n?(r.opacity=0,l.opacity=1):r.opacity=1,t(e.next).css(r),H.animate(e.next,l,{duration:e.speed,complete:function(t){return function(){i(),t.css({left:0})}}(t(e.next).add(e.prev)),queue:!1,easing:s}),o&&(e.rewind=!e.rewind),e.prev&&(r={left:0},l={left:a*(e.rewind?1:-1)},n&&(r.opacity=1,l.opacity=0),t(e.prev).css(r),H.animate(e.prev,l,{duration:e.speed,queue:!1,easing:s,complete:function(){t(this).css("opacity",0)}}))};return{fade:function(e,i){t(e.next).css({opacity:0,left:0}).show(),H.animate(e.next,{opacity:1},{duration:e.speed,complete:i}),e.prev&&(t(e.prev).css("opacity",1).show(),H.animate(e.prev,{opacity:0},{duration:e.speed}))},flash:function(e,i){t(e.next).css({opacity:0,left:0}),e.prev?H.animate(e.prev,{opacity:0},{duration:e.speed/2,complete:function(){H.animate(e.next,{opacity:1},{duration:e.speed,complete:i})}}):H.animate(e.next,{opacity:1},{duration:e.speed,complete:i})},pulse:function(e,i){e.prev&&t(e.prev).hide(),t(e.next).css({opacity:0,left:0}).show(),H.animate(e.next,{opacity:1},{duration:e.speed,complete:i})},slide:function(){e.apply(this,H.array(arguments))},fadeslide:function(){e.apply(this,H.array(arguments).concat([!0]))},doorslide:function(){e.apply(this,H.array(arguments).concat([!1,!0]))}}}();S.listen(),Galleria=function(){var n=this;this._options={},this._playing=!1,this._playtime=5e3,this._active=null,this._queue={length:0},this._data=[],this._dom={},this._thumbnails=[],this._layers=[],this._initialized=!1,this._firstrun=!1,this._stageWidth=0,this._stageHeight=0,this._target=e,this._binds=[],this._id=parseInt(1e4*Math.random(),10);var a="container stage images image-nav image-nav-left image-nav-right info info-text info-title info-description thumbnails thumbnails-list thumbnails-container thumb-nav-left thumb-nav-right loader counter tooltip",r="current total";t.each(a.split(" "),function(t,e){n._dom[e]=H.create("galleria-"+e)}),t.each(r.split(" "),function(t,e){n._dom[e]=H.create("galleria-"+e,"span")});var l=this._keyboard={keys:{UP:38,DOWN:40,LEFT:37,RIGHT:39,RETURN:13,ESCAPE:27,BACKSPACE:8,SPACE:32},map:{},bound:!1,press:function(t){var e=t.keyCode||t.which;e in l.map&&"function"==typeof l.map[e]&&l.map[e].call(n,t)},attach:function(t){var e,i;for(e in t)t.hasOwnProperty(e)&&(i=e.toUpperCase(),i in l.keys?l.map[l.keys[i]]=t[e]:l.map[i]=t[e]);l.bound||(l.bound=!0,o.bind("keydown",l.press))},detach:function(){l.bound=!1,l.map={},o.unbind("keydown",l.press)}},h=this._controls={0:e,1:e,active:0,swap:function(){h.active=h.active?0:1},getActive:function(){return h[h.active]},getNext:function(){return h[1-h.active]}},c=this._carousel={next:n.$("thumb-nav-right"),prev:n.$("thumb-nav-left"),width:0,current:0,max:0,hooks:[],update:function(){var e=0,i=0,o=[0];t.each(n._thumbnails,function(n,s){s.ready&&(e+=s.outerWidth||t(s.container).outerWidth(!0),o[n+1]=e,i=Math.max(i,s.outerHeight||t(s.container).outerHeight(!0)))}),n.$("thumbnails").css({width:e,height:i}),c.max=e,c.hooks=o,c.width=n.$("thumbnails-list").width(),c.setClasses(),n.$("thumbnails-container").toggleClass("galleria-carousel",e>c.width),c.width=n.$("thumbnails-list").width()},bindControls:function(){var t;c.next.bind("click",function(e){if(e.preventDefault(),"auto"===n._options.carouselSteps){for(t=c.current;t<c.hooks.length;t++)if(c.hooks[t]-c.hooks[c.current]>c.width){c.set(t-2);break}}else c.set(c.current+n._options.carouselSteps)}),c.prev.bind("click",function(e){if(e.preventDefault(),"auto"===n._options.carouselSteps)for(t=c.current;t>=0;t--){if(c.hooks[c.current]-c.hooks[t]>c.width){c.set(t+2);break}if(0===t){c.set(0);break}}else c.set(c.current-n._options.carouselSteps)})},set:function(t){for(t=Math.max(t,0);c.hooks[t-1]+c.width>=c.max&&t>=0;)t--;c.current=t,c.animate()},getLast:function(t){return(t||c.current)-1},follow:function(t){if(0===t||t===c.hooks.length-2)return c.set(t),void 0;for(var e=c.current;c.hooks[e]-c.hooks[c.current]<c.width&&e<=c.hooks.length;)e++;t-1<c.current?c.set(t-1):t+2>e&&c.set(t-e+c.current+2)},setClasses:function(){c.prev.toggleClass("disabled",!c.current),c.next.toggleClass("disabled",c.hooks[c.current]+c.width>=c.max)},animate:function(){c.setClasses();var t=-1*c.hooks[c.current];isNaN(t)||H.animate(n.get("thumbnails"),{left:t},{duration:n._options.carouselSpeed,easing:n._options.easing,queue:!1})}},u=this._tooltip={initialized:!1,open:!1,timer:"tooltip"+n._id,swapTimer:"swap"+n._id,init:function(){u.initialized=!0;var t=".galleria-tooltip{padding:3px 8px;max-width:50%;background:#ffe;color:#000;z-index:3;position:absolute;font-size:11px;line-height:1.3opacity:0;box-shadow:0 0 2px rgba(0,0,0,.4);-moz-box-shadow:0 0 2px rgba(0,0,0,.4);-webkit-box-shadow:0 0 2px rgba(0,0,0,.4);}";H.insertStyleTag(t),n.$("tooltip").css({opacity:.8,visibility:"visible",display:"none"})},move:function(t){var e=n.getMousePosition(t).x,i=n.getMousePosition(t).y,o=n.$("tooltip"),s=e,a=i,r=o.outerHeight(!0)+1,l=o.outerWidth(!0),h=r+15,c=n.$("container").width()-l-2,u=n.$("container").height()-r-2;isNaN(s)||isNaN(a)||(s+=10,a-=30,s=Math.max(0,Math.min(c,s)),a=Math.max(0,Math.min(u,a)),h>i&&(a=h),o.css({left:s,top:a}))},bind:function(e,i){if(!Galleria.TOUCH){u.initialized||u.init();var o=function(e,i){u.define(e,i),t(e).hover(function(){H.clearTimer(u.swapTimer),n.$("container").unbind("mousemove",u.move).bind("mousemove",u.move).trigger("mousemove"),u.show(e),H.addTimer(u.timer,function(){n.$("tooltip").stop().show().animate({opacity:1}),u.open=!0},u.open?0:500)},function(){n.$("container").unbind("mousemove",u.move),H.clearTimer(u.timer),n.$("tooltip").stop().animate({opacity:0},200,function(){n.$("tooltip").hide(),H.addTimer(u.swapTimer,function(){u.open=!1},1e3)})}).click(function(){t(this).trigger("mouseout")})};"string"==typeof i?o(e in n._dom?n.get(e):e,i):t.each(e,function(t,e){o(n.get(t),e)})}},show:function(e){e=t(e in n._dom?n.get(e):e);var o=e.data("tt"),s=function(t){i.setTimeout(function(t){return function(){u.move(t)}}(t),10),e.unbind("mouseup",s)};o="function"==typeof o?o():o,o&&(n.$("tooltip").html(o.replace(/\s/,"&nbsp;")),e.bind("mouseup",s))},define:function(e,i){if("function"!=typeof i){var o=i;i=function(){return o}}e=t(e in n._dom?n.get(e):e).data("tt",i),u.show(e)}},d=this._fullscreen={scrolled:0,crop:e,transition:e,active:!1,keymap:n._keyboard.map,enter:function(t){n._options.trueFullscreen&&S.support?S.enter(n,t):d._enter(t)},_enter:function(i){d.active=!0,H.hide(n.getActiveImage()),n.$("container").addClass("fullscreen"),d.scrolled=s.scrollTop(),H.forceStyles(n.get("container"),{position:"fixed",top:0,left:0,width:"100%",height:"100%",zIndex:1e4});var o={height:"100%",overflow:"hidden",margin:0,padding:0},a=n.getData(),r=n._options;if(H.forceStyles(f().html,o),H.forceStyles(f().body,o),d.keymap=t.extend({},n._keyboard.map),n.attachKeyboard({escape:n.exitFullscreen,right:n.next,left:n.prev}),d.crop=r.imageCrop,r.fullscreenCrop!=e&&(r.imageCrop=r.fullscreenCrop),a&&a.big&&a.image!==a.big){var l=new Galleria.Picture,h=l.isCached(a.big),c=n.getIndex(),u=n._thumbnails[c];n.trigger({type:Galleria.LOADSTART,cached:h,rewind:!1,index:c,imageTarget:n.getActiveImage(),thumbTarget:u,galleriaData:a}),l.load(a.big,function(e){n._scaleImage(e,{complete:function(e){n.trigger({type:Galleria.LOADFINISH,cached:h,index:c,rewind:!1,imageTarget:e.image,thumbTarget:u});var i=n._controls.getActive().image;i&&t(i).width(e.image.width).height(e.image.height).attr("style",t(e.image).attr("style")).attr("src",e.image.src)}})})}n.rescale(function(){H.addTimer(!1,function(){H.show(n.getActiveImage()),"function"==typeof i&&i.call(n)},100),n.trigger(Galleria.FULLSCREEN_ENTER)}),s.resize(function(){d.scale()})},scale:function(){n.rescale()},exit:function(t){n._options.trueFullscreen&&S.support?S.exit(t):d._exit(t)},_exit:function(t){d.active=!1,H.hide(n.getActiveImage()),n.$("container").removeClass("fullscreen"),H.revertStyles(n.get("container"),f().html,f().body),i.scrollTo(0,d.scrolled),n.detachKeyboard(),n.attachKeyboard(d.keymap),n._options.imageCrop=d.crop;var e=n.getData().big,o=n._controls.getActive().image;!n.getData().iframe&&o&&e&&e==o.src&&i.setTimeout(function(t){return function(){o.src=t}}(n.getData().image),1),n.rescale(function(){H.addTimer(!1,function(){H.show(n.getActiveImage()),"function"==typeof t&&t.call(n),s.trigger("resize")},50),n.trigger(Galleria.FULLSCREEN_EXIT)}),s.unbind("resize",d.scale)}},p=this._idle={timer:"idle"+n._id,trunk:[],bound:!1,add:function(e,i){if(e){p.bound||p.addEvent(),e=t(e);var n,o={};for(n in i)i.hasOwnProperty(n)&&(o[n]=e.css(n));e.data("idle",{from:o,to:i,complete:!0,busy:!1}),p.addTimer(),p.trunk.push(e)}},remove:function(e){e=jQuery(e),t.each(p.trunk,function(t,i){i&&i.length&&!i.not(e).length&&(n._idle.show(e),n._idle.trunk.splice(t,1))}),p.trunk.length||(p.removeEvent(),H.clearTimer(p.timer))},addEvent:function(){p.bound=!0,n.$("container").bind("mousemove click",p.showAll)},removeEvent:function(){p.bound=!1,n.$("container").unbind("mousemove click",p.showAll)},addTimer:function(){H.addTimer(p.timer,function(){p.hide()},n._options.idleTime)},hide:function(){n._options.idleMode&&n.getIndex()!==!1&&!n.getData().iframe&&(n.trigger(Galleria.IDLE_ENTER),t.each(p.trunk,function(t,e){var i=e.data("idle");i&&(e.data("idle").complete=!1,H.animate(e,i.to,{duration:n._options.idleSpeed}))}))},showAll:function(){H.clearTimer(p.timer),t.each(p.trunk,function(t,e){p.show(e)})},show:function(e){var i=e.data("idle");i.busy||i.complete||(i.busy=!0,n.trigger(Galleria.IDLE_EXIT),H.clearTimer(p.timer),H.animate(e,i.from,{duration:n._options.idleSpeed/2,complete:function(){t(this).data("idle").busy=!1,t(this).data("idle").complete=!0}})),p.addTimer()}},g=this._lightbox={width:0,height:0,initialized:!1,active:null,image:null,elems:{},keymap:!1,init:function(){if(n.trigger(Galleria.LIGHTBOX_OPEN),!g.initialized){g.initialized=!0;var e="overlay box content shadow title info close prevholder prev nextholder next counter image",i={},o=n._options,s="",a="position:absolute;",r="lightbox-",l={overlay:"position:fixed;display:none;opacity:"+o.overlayOpacity+";filter:alpha(opacity="+100*o.overlayOpacity+");top:0;left:0;width:100%;height:100%;background:"+o.overlayBackground+";z-index:99990",box:"position:fixed;display:none;width:400px;height:400px;top:50%;left:50%;margin-top:-200px;margin-left:-200px;z-index:99991",shadow:a+"background:#000;width:100%;height:100%;",content:a+"background-color:#fff;top:10px;left:10px;right:10px;bottom:10px;overflow:hidden",info:a+"bottom:10px;left:10px;right:10px;color:#444;font:11px/13px arial,sans-serif;height:13px",close:a+"top:10px;right:10px;height:20px;width:20px;background:#fff;text-align:center;cursor:pointer;color:#444;font:16px/22px arial,sans-serif;z-index:99999",image:a+"top:10px;left:10px;right:10px;bottom:30px;overflow:hidden;display:block;",prevholder:a+"width:50%;top:0;bottom:40px;cursor:pointer;",nextholder:a+"width:50%;top:0;bottom:40px;right:-1px;cursor:pointer;",prev:a+"top:50%;margin-top:-20px;height:40px;width:30px;background:#fff;left:20px;display:none;text-align:center;color:#000;font:bold 16px/36px arial,sans-serif",next:a+"top:50%;margin-top:-20px;height:40px;width:30px;background:#fff;right:20px;left:auto;display:none;font:bold 16px/36px arial,sans-serif;text-align:center;color:#000",title:"float:left",counter:"float:right;margin-left:8px;"},h=function(e){return e.hover(function(){t(this).css("color","#bbb")},function(){t(this).css("color","#444")})},c={};m&&m>7&&(l.nextholder+="background:#000;filter:alpha(opacity=0);",l.prevholder+="background:#000;filter:alpha(opacity=0);"),t.each(l,function(t,e){s+=".galleria-"+r+t+"{"+e+"}"}),s+=".galleria-"+r+"box.iframe .galleria-"+r+"prevholder,.galleria-"+r+"box.iframe .galleria-"+r+"nextholder{width:100px;height:100px;top:50%;margin-top:-70px}",H.insertStyleTag(s),t.each(e.split(" "),function(t,e){n.addElement("lightbox-"+e),i[e]=g.elems[e]=n.get("lightbox-"+e)}),g.image=new Galleria.Picture,t.each({box:"shadow content close prevholder nextholder",info:"title counter",content:"info image",prevholder:"prev",nextholder:"next"},function(e,i){var n=[];t.each(i.split(" "),function(t,e){n.push(r+e)}),c[r+e]=n}),n.append(c),t(i.image).append(g.image.container),t(f().body).append(i.overlay,i.box),H.optimizeTouch(i.box),h(t(i.close).bind("click",g.hide).html("&#215;")),t.each(["Prev","Next"],function(e,n){var o=t(i[n.toLowerCase()]).html(/v/.test(n)?"&#8249;&nbsp;":"&nbsp;&#8250;"),s=t(i[n.toLowerCase()+"holder"]);return s.bind("click",function(){g["show"+n]()}),8>m||Galleria.TOUCH?(o.show(),void 0):(s.hover(function(){o.show()},function(){o.stop().fadeOut(200)}),void 0)}),t(i.overlay).bind("click",g.hide),Galleria.IPAD&&(n._options.lightboxTransitionSpeed=0)}},rescale:function(e){var i=Math.min(s.width()-40,g.width),o=Math.min(s.height()-60,g.height),a=Math.min(i/g.width,o/g.height),r=Math.round(g.width*a)+40,l=Math.round(g.height*a)+60,h={width:r,height:l,"margin-top":-1*Math.ceil(l/2),"margin-left":-1*Math.ceil(r/2)};e?t(g.elems.box).css(h):t(g.elems.box).animate(h,{duration:n._options.lightboxTransitionSpeed,easing:n._options.easing,complete:function(){var e=g.image,i=n._options.lightboxFadeSpeed;n.trigger({type:Galleria.LIGHTBOX_IMAGE,imageTarget:e.image}),t(e.container).show(),t(e.image).animate({opacity:1},i),H.show(g.elems.info,i)}})},hide:function(){g.image.image=null,s.unbind("resize",g.rescale),t(g.elems.box).hide(),H.hide(g.elems.info),n.detachKeyboard(),n.attachKeyboard(g.keymap),g.keymap=!1,H.hide(g.elems.overlay,200,function(){t(this).hide().css("opacity",n._options.overlayOpacity),n.trigger(Galleria.LIGHTBOX_CLOSE)})},showNext:function(){g.show(n.getNext(g.active))},showPrev:function(){g.show(n.getPrev(g.active))},show:function(e){g.active=e="number"==typeof e?e:n.getIndex()||0,g.initialized||g.init(),g.keymap||(g.keymap=t.extend({},n._keyboard.map),n.attachKeyboard({escape:g.hide,right:g.showNext,left:g.showPrev})),s.unbind("resize",g.rescale);var o,a,r,l=n.getData(e),h=n.getDataLength(),c=n.getNext(e);H.hide(g.elems.info);try{for(r=n._options.preload;r>0;r--)a=new Galleria.Picture,o=n.getData(c),a.preload("big"in o?o.big:o.image),c=n.getNext(c)}catch(u){}g.image.isIframe=!!l.iframe,t(g.elems.box).toggleClass("iframe",!!l.iframe),g.image.load(l.iframe||l.big||l.image,function(n){g.width=n.isIframe?t(i).width():n.original.width,g.height=n.isIframe?t(i).height():n.original.height,t(n.image).css({width:n.isIframe?"100%":"100.1%",height:n.isIframe?"100%":"100.1%",top:0,zIndex:99998,opacity:0,visibility:"visible"}),g.elems.title.innerHTML=l.title||"",g.elems.counter.innerHTML=e+1+" / "+h,s.resize(g.rescale),g.rescale()}),t(g.elems.overlay).show().css("visibility","visible"),t(g.elems.box).show()}};return this},Galleria.prototype={constructor:Galleria,init:function(i,n){return n=w(n),this._original={target:i,options:n,data:null},this._target=this._dom.target=i.nodeName?i:t(i).get(0),this._original.html=this._target.innerHTML,_.push(this),this._target?(this._options={autoplay:!1,carousel:!0,carouselFollow:!0,carouselSpeed:400,carouselSteps:"auto",clicknext:!1,dailymotion:{foreground:"%23EEEEEE",highlight:"%235BCEC5",background:"%23222222",logo:0,hideInfos:1},dataConfig:function(){return{}},dataSelector:"img",dataSource:this._target,debug:e,dummy:e,easing:"galleria",extend:function(){},fullscreenCrop:e,fullscreenDoubleTap:!0,fullscreenTransition:e,height:0,idleMode:!0,idleTime:3e3,idleSpeed:200,imageCrop:!1,imageMargin:0,imagePan:!1,imagePanSmoothness:12,imagePosition:"50%",imageTimeout:e,initialTransition:e,keepSource:!1,layerFollow:!0,lightbox:!1,lightboxFadeSpeed:200,lightboxTransitionSpeed:200,linkSourceImages:!0,maxScaleRatio:e,minScaleRatio:e,overlayOpacity:.85,overlayBackground:"#0b0b0b",pauseOnInteraction:!0,popupLinks:!1,preload:2,queue:!0,responsive:!1,show:0,showInfo:!0,showCounter:!0,showImagenav:!0,swipe:!0,thumbCrop:!0,thumbEventType:"click",thumbFit:!0,thumbMargin:0,thumbQuality:"auto",thumbnails:!0,touchTransition:e,transition:"fade",transitionInitial:e,transitionSpeed:400,trueFullscreen:!0,useCanvas:!1,vimeo:{title:0,byline:0,portrait:0,color:"aaaaaa"},wait:5e3,width:"auto",youtube:{modestbranding:1,autohide:1,color:"white",hd:1,rel:0,showinfo:0}},this._options.initialTransition=this._options.initialTransition||this._options.transitionInitial,n&&n.debug===!1&&(l=!1),n&&"number"==typeof n.imageTimeout&&(h=n.imageTimeout),n&&"string"==typeof n.dummy&&(c=n.dummy),t(this._target).children().hide(),"object"==typeof Galleria.theme?this._init():M.push(this),this):(Galleria.raise("Target not found",!0),void 0)},_init:function(){var e=this,o=this._options;if(this._initialized)return Galleria.raise("Init failed: Gallery instance already initialized."),this;if(this._initialized=!0,!Galleria.theme)return Galleria.raise("Init failed: No theme found.",!0),this;if(t.extend(!0,o,Galleria.theme.defaults,this._original.options,Galleria.configure.options),function(t){return"getContext"in t?(O=O||{elem:t,context:t.getContext("2d"),cache:{},length:0},void 0):(t=null,void 0)}(n.createElement("canvas")),this.bind(Galleria.DATA,function(){Galleria.QUIRK&&Galleria.raise("Your page is in Quirks mode, Galleria may not render correctly. Please validate your HTML."),this._original.data=this._data,this.get("total").innerHTML=this.getDataLength();var t=this.$("container"),n={width:0,height:0},o=function(){return e.$("stage").height()};H.wait({until:function(){return n=e._getWH(),t.width(n.width).height(n.height),o()&&n.width&&n.height>50},success:function(){e._width=n.width,e._height=n.height,Galleria.WEBKIT?i.setTimeout(function(){e._run()},1):e._run()},error:function(){o()?Galleria.raise("Could not extract sufficient width/height of the gallery container. Traced measures: width:"+n.width+"px, height: "+n.height+"px.",!0):Galleria.raise("Could not extract a stage height from the CSS. Traced height: "+o()+"px.",!0)},timeout:"number"==typeof this._options.wait?this._options.wait:!1})}),this.append({"info-text":["info-title","info-description"],info:["info-text"],"image-nav":["image-nav-right","image-nav-left"],stage:["images","loader","counter","image-nav"],"thumbnails-list":["thumbnails"],"thumbnails-container":["thumb-nav-left","thumbnails-list","thumb-nav-right"],container:["stage","thumbnails-container","info","tooltip"]}),H.hide(this.$("counter").append(this.get("current"),n.createTextNode(" / "),this.get("total"))),this.setCounter("&#8211;"),H.hide(e.get("tooltip")),this.$("container").addClass(Galleria.TOUCH?"touch":"notouch"),t.each(new Array(2),function(i){var n=new Galleria.Picture;t(n.container).css({position:"absolute",top:0,left:0}).prepend(e._layers[i]=t(H.create("galleria-layer")).css({position:"absolute",top:0,left:0,right:0,bottom:0,zIndex:2})[0]),e.$("images").append(n.container),e._controls[i]=n}),this.$("images").css({position:"relative",top:0,left:0,width:"100%",height:"100%"}),this.$("thumbnails, thumbnails-list").css({overflow:"hidden",position:"relative"}),this.$("image-nav-right, image-nav-left").bind("click",function(t){o.clicknext&&t.stopPropagation(),o.pauseOnInteraction&&e.pause();var i=/right/.test(this.className)?"next":"prev";e[i]()}),t.each(["info","counter","image-nav"],function(t,i){o["show"+i.substr(0,1).toUpperCase()+i.substr(1).replace(/-/,"")]===!1&&H.moveOut(e.get(i.toLowerCase()))}),this.load(),o.keepSource||m||(this._target.innerHTML=""),this.get("errors")&&this.appendChild("target","errors"),this.appendChild("target","container"),o.carousel){var a=0,r=o.show;this.bind(Galleria.THUMBNAIL,function(){this.updateCarousel(),++a==this.getDataLength()&&"number"==typeof r&&r>0&&this._carousel.follow(r)})}return o.responsive&&s.bind("resize",function(){e.isFullscreen()||e.resize()}),o.swipe&&(!function(t){var i,n=[0,0],o=[0,0],s=30,a=100,r=!1,l=0,h={start:"touchstart",move:"touchmove",stop:"touchend"},c=function(t){return t.originalEvent.touches?t.originalEvent.touches[0]:t},u=function(t){t.originalEvent.touches&&t.originalEvent.touches.length>1||(i=c(t),o=[i.pageX,i.pageY],n[0]||(n=o),Math.abs(n[0]-o[0])>10&&t.preventDefault())},d=function(i){return t.unbind(h.move,u),i.originalEvent.touches&&i.originalEvent.touches.length||r?(r=!r,void 0):(H.timestamp()-l<1e3&&Math.abs(n[0]-o[0])>s&&Math.abs(n[1]-o[1])<a&&(i.preventDefault(),e[n[0]>o[0]?"next":"prev"]()),n=o=[0,0],void 0)};t.bind(h.start,function(e){e.originalEvent.touches&&e.originalEvent.touches.length>1||(i=c(e),l=H.timestamp(),n=o=[i.pageX,i.pageY],t.bind(h.move,u).one(h.stop,d))})}(e.$("images")),o.fullscreenDoubleTap&&this.$("stage").bind("touchstart",function(){var t,i,n,o,s,a,r=function(t){return t.originalEvent.touches?t.originalEvent.touches[0]:t};return function(l){return a=Galleria.utils.timestamp(),i=r(l).pageX,n=r(l).pageY,500>a-t&&20>i-o&&20>n-s?(e.toggleFullscreen(),l.preventDefault(),e.$("stage").unbind("touchend",arguments.callee),void 0):(t=a,o=i,s=n,void 0)}}())),H.optimizeTouch(this.get("container")),t.each(Galleria.on.binds,function(i,n){-1==t.inArray(n.hash,e._binds)&&e.bind(n.type,n.callback)}),this},_getWH:function(){var e,i=this.$("container"),n=this.$("target"),o=this,s={};return t.each(["width","height"],function(t,a){o._options[a]&&"number"==typeof o._options[a]?s[a]=o._options[a]:(e=[H.parseValue(i.css(a)),H.parseValue(n.css(a)),i[a](),n[a]()],o["_"+a]||e.splice(e.length,H.parseValue(i.css("min-"+a)),H.parseValue(n.css("min-"+a))),s[a]=Math.max.apply(Math,e))}),o._options.height&&o._options.height<2&&(s.height=s.width*o._options.height),s},_createThumbnails:function(){this.get("total").innerHTML=this.getDataLength();var e,o,s,a,r,l,h=this,c=this._options,u=function(){var t=h.$("thumbnails").find(".active");
return t.length?t.find("img").attr("src"):!1}(),d="string"==typeof c.thumbnails?c.thumbnails.toLowerCase():null,p=function(t){return n.defaultView&&n.defaultView.getComputedStyle?n.defaultView.getComputedStyle(s.container,null)[t]:l.css(t)},g=function(e,i,n){return function(){t(n).append(e),h.trigger({type:Galleria.THUMBNAIL,thumbTarget:e,index:i,galleriaData:h.getData(i)})}},m=function(e){c.pauseOnInteraction&&h.pause();var i=t(e.currentTarget).data("index");h.getIndex()!==i&&h.show(i),e.preventDefault()},f=function(e){e.scale({width:e.data.width,height:e.data.height,crop:c.thumbCrop,margin:c.thumbMargin,canvas:c.useCanvas,complete:function(e){var i,n,o=["left","top"],s=["Width","Height"],a=h.getData(e.index),r=a.thumb.split(":");t.each(s,function(s,a){i=a.toLowerCase(),c.thumbCrop===!0&&c.thumbCrop!==i||!c.thumbFit||(n={},n[i]=e[i],t(e.container).css(n),n={},n[o[s]]=0,t(e.image).css(n)),e["outer"+a]=t(e.container)["outer"+a](!0)}),H.toggleQuality(e.image,c.thumbQuality===!0||"auto"===c.thumbQuality&&e.original.width<3*e.width),a.iframe&&2==r.length&&r[0]in T&&T[r[0]].getThumb(r[1],function(t){return function(e){t.src=e}}(e.image)),h.trigger({type:Galleria.THUMBNAIL,thumbTarget:e.image,index:e.data.order,galleriaData:h.getData(e.data.order)})}})};for(this._thumbnails=[],this.$("thumbnails").empty(),e=0;this._data[e];e++)a=this._data[e],c.thumbnails===!0&&(a.thumb||a.image)?(s=new Galleria.Picture(e),s.index=e,o=a.thumb||a.image,this.$("thumbnails").append(s.container),l=t(s.container),s.data={width:H.parseValue(p("width")),height:H.parseValue(p("height")),order:e},c.thumbFit&&c.thumbCrop!==!0?l.css({width:"auto",height:"auto"}):l.css({width:s.data.width,height:s.data.height}),r=o.split(":"),2==r.length&&r[0]in T?s.load("data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw%3D%3D",{height:s.data.height,width:1.25*s.data.height},f):s.load(o,f),"all"===c.preload&&s.preload(a.image)):a.iframe||"empty"===d||"numbers"===d?(s={container:H.create("galleria-image"),image:H.create("img","span"),ready:!0},"numbers"===d&&t(s.image).text(e+1),a.iframe&&t(s.image).addClass("iframe"),this.$("thumbnails").append(s.container),i.setTimeout(g(s.image,e,s.container),50+20*e)):s={container:null,image:null},t(s.container).add(c.keepSource&&c.linkSourceImages?a.original:null).data("index",e).bind(c.thumbEventType,m),u===o&&t(s.container).addClass("active"),this._thumbnails.push(s)},_run:function(){var n=this;n._createThumbnails(),H.wait({timeout:1e4,until:function(){return Galleria.OPERA&&n.$("stage").css("display","inline-block"),n._stageWidth=n.$("stage").width(),n._stageHeight=n.$("stage").height(),n._stageWidth&&n._stageHeight>50},success:function(){return x.push(n),H.show(n.get("counter")),n._options.carousel&&n._carousel.bindControls(),n._options.autoplay&&(n.pause(),"number"==typeof n._options.autoplay&&(n._playtime=n._options.autoplay),n.trigger(Galleria.PLAY),n._playing=!0),n._firstrun?("number"==typeof n._options.show&&n.show(n._options.show),void 0):(n._firstrun=!0,Galleria.History&&Galleria.History.change(function(t){isNaN(t)?i.history.go(-1):n.show(t,e,!0)}),n.trigger(Galleria.READY),Galleria.theme.init.call(n,n._options),t.each(Galleria.ready.callbacks,function(){this.call(n,n._options)}),n._options.extend.call(n,n._options),/^[0-9]{1,4}$/.test(d)&&Galleria.History?n.show(d,e,!0):n._data[n._options.show]&&n.show(n._options.show),void 0)},error:function(){Galleria.raise("Stage width or height is too small to show the gallery. Traced measures: width:"+n._stageWidth+"px, height: "+n._stageHeight+"px.",!0)}})},load:function(e,i,n){var o=this;return this._data=[],this._thumbnails=[],this.$("thumbnails").empty(),"function"==typeof i&&(n=i,i=null),e=e||this._options.dataSource,i=i||this._options.dataSelector,n=n||this._options.dataConfig,/^function Object/.test(e.constructor)&&(e=[e]),e.constructor===Array?(this.validate(e)?(this._data=e,this._parseData().trigger(Galleria.DATA)):Galleria.raise("Load failed: JSON Array not valid."),this):(i+=",.video,.iframe",t(e).find(i).each(function(e,i){i=t(i);var s={},a=i.parent(),r=a.attr("href"),l=a.attr("rel");r&&("IMG"==i[0].nodeName||i.hasClass("video"))&&E(r)?s.video=r:r&&i.hasClass("iframe")?s.iframe=r:s.image=s.big=r,l&&(s.big=l),t.each("big title description link layer".split(" "),function(t,e){i.data(e)&&(s[e]=i.data(e))}),o._data.push(t.extend({title:i.attr("title")||"",thumb:i.attr("src"),image:i.attr("src"),big:i.attr("src"),description:i.attr("alt")||"",link:i.attr("longdesc"),original:i.get(0)},s,n(i)))}),this.getDataLength()&&this._parseData().trigger(Galleria.DATA),this)},_parseData:function(){var e,i=this;return t.each(this._data,function(n,o){if(e=i._data[n],"thumb"in o==!1&&(e.thumb=o.image),!1 in o&&(e.big=o.image),"video"in o){var s=E(o.video);s&&(e.iframe=T[s.provider].embed(s.id)+function(){if("object"==typeof i._options[s.provider]){var e="?",n=[];return t.each(i._options[s.provider],function(t,e){n.push(t+"="+e)}),"youtube"==s.provider&&(n=["wmode=opaque"].concat(n)),e+n.join("&")}return""}(),delete e.video,"thumb"in e&&e.thumb||(e.thumb=s.provider+":"+s.id))}}),this},destroy:function(){return this.get("target").innerHTML=this._original.html,this},splice:function(){var t=this,e=H.array(arguments);return i.setTimeout(function(){a.splice.apply(t._data,e),t._parseData()._createThumbnails()},2),t},push:function(){var t=this,e=H.array(arguments);return i.setTimeout(function(){a.push.apply(t._data,e),t._parseData()._createThumbnails()},2),t},_getActive:function(){return this._controls.getActive()},validate:function(){return!0},bind:function(t,e){return t=b(t),this.$("container").bind(t,this.proxy(e)),this},unbind:function(t){return t=b(t),this.$("container").unbind(t),this},trigger:function(e){return e="object"==typeof e?t.extend(e,{scope:this}):{type:b(e),scope:this},this.$("container").trigger(e),this},addIdleState:function(){return this._idle.add.apply(this._idle,H.array(arguments)),this},removeIdleState:function(){return this._idle.remove.apply(this._idle,H.array(arguments)),this},enterIdleMode:function(){return this._idle.hide(),this},exitIdleMode:function(){return this._idle.showAll(),this},enterFullscreen:function(){return this._fullscreen.enter.apply(this,H.array(arguments)),this},exitFullscreen:function(){return this._fullscreen.exit.apply(this,H.array(arguments)),this},toggleFullscreen:function(){return this._fullscreen[this.isFullscreen()?"exit":"enter"].apply(this,H.array(arguments)),this},bindTooltip:function(){return this._tooltip.bind.apply(this._tooltip,H.array(arguments)),this},defineTooltip:function(){return this._tooltip.define.apply(this._tooltip,H.array(arguments)),this},refreshTooltip:function(){return this._tooltip.show.apply(this._tooltip,H.array(arguments)),this},openLightbox:function(){return this._lightbox.show.apply(this._lightbox,H.array(arguments)),this},closeLightbox:function(){return this._lightbox.hide.apply(this._lightbox,H.array(arguments)),this},getActiveImage:function(){return this._getActive().image||e},getActiveThumb:function(){return this._thumbnails[this._active].image||e},getMousePosition:function(t){return{x:t.pageX-this.$("container").offset().left,y:t.pageY-this.$("container").offset().top}},addPan:function(e){if(this._options.imageCrop!==!1){e=t(e||this.getActiveImage());var i=this,n=e.width()/2,o=e.height()/2,s=parseInt(e.css("left"),10),a=parseInt(e.css("top"),10),r=s||0,l=a||0,h=0,c=0,u=!1,d=H.timestamp(),p=0,g=0,f=function(t,i,n){if(t>0&&(g=Math.round(Math.max(-1*t,Math.min(0,i))),p!==g))if(p=g,8===m)e.parent()["scroll"+n](-1*g);else{var o={};o[n.toLowerCase()]=g,e.css(o)}},v=function(t){H.timestamp()-d<50||(u=!0,n=i.getMousePosition(t).x,o=i.getMousePosition(t).y)},y=function(){u&&(h=e.width()-i._stageWidth,c=e.height()-i._stageHeight,s=n/i._stageWidth*h*-1,a=o/i._stageHeight*c*-1,r+=(s-r)/i._options.imagePanSmoothness,l+=(a-l)/i._options.imagePanSmoothness,f(c,l,"Top"),f(h,r,"Left"))};return 8===m&&(e.parent().scrollTop(-1*l).scrollLeft(-1*r),e.css({top:0,left:0})),this.$("stage").unbind("mousemove",v).bind("mousemove",v),H.addTimer("pan"+i._id,y,50,!0),this}},proxy:function(t,e){return"function"!=typeof t?p:(e=e||this,function(){return t.apply(e,H.array(arguments))})},removePan:function(){return this.$("stage").unbind("mousemove"),H.clearTimer("pan"+this._id),this},addElement:function(){var e=this._dom;return t.each(H.array(arguments),function(t,i){e[i]=H.create("galleria-"+i)}),this},attachKeyboard:function(){return this._keyboard.attach.apply(this._keyboard,H.array(arguments)),this},detachKeyboard:function(){return this._keyboard.detach.apply(this._keyboard,H.array(arguments)),this},appendChild:function(t,e){return this.$(t).append(this.get(e)||e),this},prependChild:function(t,e){return this.$(t).prepend(this.get(e)||e),this},remove:function(){return this.$(H.array(arguments).join(",")).remove(),this},append:function(t){var e,i;for(e in t)if(t.hasOwnProperty(e))if(t[e].constructor===Array)for(i=0;t[e][i];i++)this.appendChild(e,t[e][i]);else this.appendChild(e,t[e]);return this},_scaleImage:function(e,i){if(e=e||this._controls.getActive()){var n,o=function(e){t(e.container).children(":first").css({top:Math.max(0,H.parseValue(e.image.style.top)),left:Math.max(0,H.parseValue(e.image.style.left)),width:H.parseValue(e.image.width),height:H.parseValue(e.image.height)})};return i=t.extend({width:this._stageWidth,height:this._stageHeight,crop:this._options.imageCrop,max:this._options.maxScaleRatio,min:this._options.minScaleRatio,margin:this._options.imageMargin,position:this._options.imagePosition},i),this._options.layerFollow&&this._options.imageCrop!==!0?"function"==typeof i.complete?(n=i.complete,i.complete=function(){n.call(e,e),o(e)}):i.complete=o:t(e.container).children(":first").css({top:0,left:0}),e.scale(i),this}},updateCarousel:function(){return this._carousel.update(),this},resize:function(i,n){"function"==typeof i&&(n=i,i=e),i=t.extend({width:0,height:0},i);var o,s=this,a=this.$("container"),r=!("aspect"!=this._options.responsive||i.width&&i.height);return t.each(i,function(t,e){e||(a[t]("auto"),i[t]=s._getWH()[t])}),r&&(o=Math.min(i.width/this._width,i.height/this._height)),t.each(i,function(t,e){a[t](o?o*s["_"+t]:e)}),this.rescale(n)},rescale:function(t,i,n){var o=this;"function"==typeof t&&(n=t,t=e);var s=function(){o._stageWidth=t||o.$("stage").width(),o._stageHeight=i||o.$("stage").height(),o._scaleImage(),o._options.carousel&&o.updateCarousel(),o.trigger(Galleria.RESCALE),"function"==typeof n&&n.call(o)};return!Galleria.WEBKIT||Galleria.TOUCH||t||i?s.call(o):H.addTimer(!1,s,10),this},refreshImage:function(){return this._scaleImage(),this._options.imagePan&&this.addPan(),this},show:function(t,e,i){return t===!1||!this._options.queue&&this._queue.stalled?void 0:(t=Math.max(0,Math.min(parseInt(t,10),this.getDataLength()-1)),e="undefined"!=typeof e?!!e:t<this.getIndex(),i=i||!1,!i&&Galleria.History?(Galleria.History.set(t.toString()),void 0):(this._active=t,a.push.call(this._queue,{index:t,rewind:e}),this._queue.stalled||this._show(),this))},_show:function(){var n=this,o=this._queue[0],s=this.getData(o.index);if(s){var r=s.iframe||(this.isFullscreen()&&"big"in s?s.big:s.image),l=this._controls.getActive(),h=this._controls.getNext(),c=h.isCached(r),u=this._thumbnails[o.index],d=function(){t(h.image).trigger("mouseup")},p=function(e,o,s,r,l){return function(){var h;n._queue.stalled=!1,H.toggleQuality(o.image,n._options.imageQuality),n._layers[n._controls.active].innerHTML="",t(s.container).css({zIndex:0,opacity:0}).show(),s.isIframe&&t(s.container).find("iframe").remove(),n.$("container").toggleClass("iframe",!!e.iframe),t(o.container).css({zIndex:1,left:0,top:0}).show(),n._controls.swap(),n._options.imagePan&&n.addPan(o.image),(e.link||n._options.lightbox||n._options.clicknext)&&t(o.image).css({cursor:"pointer"}).bind("mouseup",function(){return n._options.clicknext&&!Galleria.TOUCH?(n._options.pauseOnInteraction&&n.pause(),n.next(),void 0):e.link?(n._options.popupLinks?h=i.open(e.link,"_blank"):i.location.href=e.link,void 0):(n._options.lightbox&&n.openLightbox(),void 0)}),a.shift.call(n._queue),n._queue.length&&n._show(),n._playCheck(),n.trigger({type:Galleria.IMAGE,index:r.index,imageTarget:o.image,thumbTarget:l.image,galleriaData:e})}}(s,h,l,o,u);if(this._options.carousel&&this._options.carouselFollow&&this._carousel.follow(o.index),this._options.preload){var g,m,f,v=this.getNext();try{for(m=this._options.preload;m>0;m--)g=new Galleria.Picture,f=n.getData(v),g.preload(this.isFullscreen()&&"big"in f?f.big:f.image),v=n.getNext(v)}catch(y){}}H.show(h.container),h.isIframe=!!s.iframe,t(n._thumbnails[o.index].container).addClass("active").siblings(".active").removeClass("active"),n.trigger({type:Galleria.LOADSTART,cached:c,index:o.index,rewind:o.rewind,imageTarget:h.image,thumbTarget:u.image,galleriaData:s}),h.load(r,function(i){var a=t(n._layers[1-n._controls.active]).html(s.layer||"").hide();n._scaleImage(i,{complete:function(i){"image"in l&&H.toggleQuality(l.image,!1),H.toggleQuality(i.image,!1),n._queue.stalled=!0,n.removePan(),n.setInfo(o.index),n.setCounter(o.index),s.layer&&(a.show(),(s.link||n._options.lightbox||n._options.clicknext)&&a.css("cursor","pointer").unbind("mouseup").mouseup(d)),n.trigger({type:Galleria.LOADFINISH,cached:c,index:o.index,rewind:o.rewind,imageTarget:i.image,thumbTarget:n._thumbnails[o.index].image,galleriaData:n.getData(o.index)});var r=n._options.transition;if(t.each({initial:null===l.image,touch:Galleria.TOUCH,fullscreen:n.isFullscreen()},function(t,i){return i&&n._options[t+"Transition"]!==e?(r=n._options[t+"Transition"],!1):void 0}),r in P==!1)p();else{var h={prev:l.container,next:i.container,rewind:o.rewind,speed:n._options.transitionSpeed||400};P[r].call(n,h,p)}}})})}},getNext:function(t){return t="number"==typeof t?t:this.getIndex(),t===this.getDataLength()-1?0:t+1},getPrev:function(t){return t="number"==typeof t?t:this.getIndex(),0===t?this.getDataLength()-1:t-1},next:function(){return this.getDataLength()>1&&this.show(this.getNext(),!1),this},prev:function(){return this.getDataLength()>1&&this.show(this.getPrev(),!0),this},get:function(t){return t in this._dom?this._dom[t]:null},getData:function(t){return t in this._data?this._data[t]:this._data[this._active]},getDataLength:function(){return this._data.length},getIndex:function(){return"number"==typeof this._active?this._active:!1},getStageHeight:function(){return this._stageHeight},getStageWidth:function(){return this._stageWidth},getOptions:function(t){return"undefined"==typeof t?this._options:this._options[t]},setOptions:function(e,i){return"object"==typeof e?t.extend(this._options,e):this._options[e]=i,this},play:function(t){return this._playing=!0,this._playtime=t||this._playtime,this._playCheck(),this.trigger(Galleria.PLAY),this},pause:function(){return this._playing=!1,this.trigger(Galleria.PAUSE),this},playToggle:function(t){return this._playing?this.pause():this.play(t)},isPlaying:function(){return this._playing},isFullscreen:function(){return this._fullscreen.active},_playCheck:function(){var t=this,e=0,i=20,n=H.timestamp(),o="play"+this._id;if(this._playing){H.clearTimer(o);var s=function(){return e=H.timestamp()-n,e>=t._playtime&&t._playing?(H.clearTimer(o),t.next(),void 0):(t._playing&&(t.trigger({type:Galleria.PROGRESS,percent:Math.ceil(e/t._playtime*100),seconds:Math.floor(e/1e3),milliseconds:e}),H.addTimer(o,s,i)),void 0)};H.addTimer(o,s,i)}},setPlaytime:function(t){return this._playtime=t,this},setIndex:function(t){return this._active=t,this},setCounter:function(t){if("number"==typeof t?t++:"undefined"==typeof t&&(t=this.getIndex()+1),this.get("current").innerHTML=t,m){var e=this.$("counter"),i=e.css("opacity");1===parseInt(i,10)?H.removeAlpha(e[0]):this.$("counter").css("opacity",i)}return this},setInfo:function(e){var i=this,n=this.getData(e);return t.each(["title","description"],function(t,e){var o=i.$("info-"+e);n[e]?o[n[e].length?"show":"hide"]().html(n[e]):o.empty().hide()}),this},hasInfo:function(t){var e,i="title description".split(" ");for(e=0;i[e];e++)if(this.getData(t)[i[e]])return!0;return!1},jQuery:function(e){var i=this,n=[];t.each(e.split(","),function(e,o){o=t.trim(o),i.get(o)&&n.push(o)});var o=t(i.get(n.shift()));return t.each(n,function(t,e){o=o.add(i.get(e))}),o},$:function(){return this.jQuery.apply(this,H.array(arguments))}},t.each(y,function(t,e){var i=/_/.test(e)?e.replace(/_/g,""):e;Galleria[e.toUpperCase()]="galleria."+i}),t.extend(Galleria,{IE9:9===m,IE8:8===m,IE7:7===m,IE6:6===m,IE:m,WEBKIT:/webkit/.test(u),CHROME:/chrome/.test(u),SAFARI:/safari/.test(u)&&!/chrome/.test(u),QUIRK:m&&n.compatMode&&"BackCompat"===n.compatMode,MAC:/mac/.test(navigator.platform.toLowerCase()),OPERA:!!i.opera,IPHONE:/iphone/.test(u),IPAD:/ipad/.test(u),ANDROID:/android/.test(u),TOUCH:"ontouchstart"in n}),Galleria.addTheme=function(t){return I(t),t},Galleria.loadTheme=function(n,o){var s=x.length,a=i.setTimeout(function(){Galleria.raise("Theme at "+n+" could not load, check theme path.",!0)},5e3);return Galleria.theme=e,H.loadScript(n,function(){if(i.clearTimeout(a),s){var e=[];t.each(Galleria.get(),function(i,n){var s=t.extend(n._original.options,{data_source:n._data},o);n.$("container").remove();var a=new Galleria;a._id=n._id,a.init(n._original.target,s),e.push(a)}),x=e}}),Galleria},Galleria.get=function(t){return _[t]?_[t]:"number"!=typeof t?_:(Galleria.raise("Gallery index "+t+" not found"),void 0)},Galleria.configure=function(e,i){var n={};return"string"==typeof e&&i?(n[e]=i,e=n):t.extend(n,e),Galleria.configure.options=n,t.each(Galleria.get(),function(t,e){e.setOptions(n)}),Galleria},Galleria.configure.options={},Galleria.on=function(e,i){if(e){i=i||p;var n=e+i.toString().replace(/\s/g,"")+H.timestamp();return t.each(Galleria.get(),function(t,o){o._binds.push(n),o.bind(e,i)}),Galleria.on.binds.push({type:e,callback:i,hash:n}),Galleria}},Galleria.on.binds=[],Galleria.run=function(e,i){return t(e||"#galleria").galleria(i),Galleria},Galleria.addTransition=function(t,e){return P[t]=e,Galleria},Galleria.utils=H,Galleria.log=function(){var e=H.array(arguments);if(!("console"in i&&"log"in i.console))return i.alert(e.join("<br>"));try{return i.console.log.apply(i.console,e)}catch(n){t.each(e,function(){i.console.log(this)})}},Galleria.ready=function(e){return t.each(x,function(t,i){e.call(i,i._options)}),Galleria.ready.callbacks.push(e),Galleria},Galleria.ready.callbacks=[],Galleria.raise=function(e,i){var n=i?"Fatal error":"Error",o={color:"#fff",position:"absolute",top:0,left:0,zIndex:1e5},s=function(e){var s='<div style="padding:4px;margin:0 0 2px;background:#'+(i?"811":"222")+'";>'+(i?"<strong>"+n+": </strong>":"")+e+"</div>";t.each(_,function(){var t=this.$("errors"),e=this.$("target");t.length||(e.css("position","relative"),t=this.addElement("errors").appendChild("target","errors").$("errors").css(o)),t.append(s)}),_.length||t("<div>").css(t.extend(o,{position:"fixed"})).append(s).appendTo(f().body)};if(l){if(s(e),i)throw new Error(n+": "+e)}else if(i){if(D)return;D=!0,i=!1,s("Gallery could not load.")}},Galleria.version=r,Galleria.requires=function(t,e){return e=e||"You need to upgrade Galleria to version "+t+" to use one or more components.",Galleria.version<t&&Galleria.raise(e,!0),Galleria},Galleria.Picture=function(e){this.id=e||null,this.image=null,this.container=H.create("galleria-image"),t(this.container).css({overflow:"hidden",position:"relative"}),this.original={width:0,height:0},this.ready=!1,this.isIframe=!1},Galleria.Picture.prototype={cache:{},show:function(){H.show(this.image)},hide:function(){H.moveOut(this.image)},clear:function(){this.image=null},isCached:function(t){return!!this.cache[t]},preload:function(e){t(new Image).load(function(t,e){return function(){e[t]=t}}(e,this.cache)).attr("src",e)},load:function(e,n,o){if("function"==typeof n&&(o=n,n=null),this.isIframe){var s="if"+(new Date).getTime();return this.image=t("<iframe>",{src:e,frameborder:0,id:s,allowfullscreen:!0,css:{visibility:"hidden"}})[0],t(this.container).find("iframe,img").remove(),this.container.appendChild(this.image),t("#"+s).load(function(e,n){return function(){i.setTimeout(function(){t(e.image).css("visibility","visible"),"function"==typeof n&&n.call(e,e)},10)}}(this,o)),this.container}this.image=new Image;var a=!1,r=!1,l=t(this.container),h=t(this.image),u=function(e,o,s){return function(){var a=function(){t(this).unbind("load"),e.original=n||{height:this.height,width:this.width},e.container.appendChild(this),e.cache[s]=s,"function"==typeof o&&i.setTimeout(function(){o.call(e,e)},1)};this.width&&this.height?a.call(this):i.setTimeout(function(e){return function(){e.width&&e.height?a.call(e):r?Galleria.raise("Could not extract width/height from image: "+e.src+". Traced measures: width:"+e.width+"px, height: "+e.height+"px."):(t(new Image).load(u).attr("src",e.src),r=!0)}}(this),2)}}(this,o,e);return l.find("iframe,img").remove(),h.css("display","block"),H.hide(this.image),t.each("minWidth minHeight maxWidth maxHeight".split(" "),function(t,e){h.css(e,/min/.test(e)?"0":"none")}),this.cache[e]?(h.load(u).attr("src",e),this.container):(h.load(u).error(function(){a?c?t(this).attr("src",c):Galleria.raise("Image not found: "+e):(a=!0,i.setTimeout(function(t,e){return function(){t.attr("src",e+"?"+H.timestamp())}}(t(this),e),50))}).attr("src",e),this.container)},scale:function(i){var n=this;if(i=t.extend({width:0,height:0,min:e,max:e,margin:0,complete:p,position:"center",crop:!1,canvas:!1},i),this.isIframe){t(this.image).width(i.width).height(i.height).removeAttr("width").removeAttr("height"),t(this.container).width(i.width).height(i.height),i.complete.call(n,n);try{this.image.contentWindow&&t(this.image.contentWindow).trigger("resize")}catch(o){}return this.container}if(!this.image)return this.container;var s,a,r,l=t(n.container);return H.wait({until:function(){return s=i.width||l.width()||H.parseValue(l.css("width")),a=i.height||l.height()||H.parseValue(l.css("height")),s&&a},success:function(){var e=(s-2*i.margin)/n.original.width,o=(a-2*i.margin)/n.original.height,l=Math.min(e,o),h=Math.max(e,o),c={"true":h,width:e,height:o,"false":l,landscape:n.original.width>n.original.height?h:l,portrait:n.original.width<n.original.height?h:l},u=c[i.crop.toString()],d="";i.max&&(u=Math.min(i.max,u)),i.min&&(u=Math.max(i.min,u)),t.each(["width","height"],function(e,i){t(n.image)[i](n[i]=n.image[i]=Math.round(n.original[i]*u))}),t(n.container).width(s).height(a),i.canvas&&O&&(O.elem.width=n.width,O.elem.height=n.height,d=n.image.src+":"+n.width+"x"+n.height,n.image.src=O.cache[d]||function(t){O.context.drawImage(n.image,0,0,n.original.width*u,n.original.height*u);try{return r=O.elem.toDataURL(),O.length+=r.length,O.cache[t]=r,r}catch(e){return n.image.src}}(d));var p={},g={},m=function(e,i,o){var s=0;if(/\%/.test(e)){var a=parseInt(e,10)/100,r=n.image[i]||t(n.image)[i]();s=Math.ceil(-1*r*a+o*a)}else s=H.parseValue(e);return s},f={top:{top:0},left:{left:0},right:{left:"100%"},bottom:{top:"100%"}};t.each(i.position.toLowerCase().split(" "),function(t,e){"center"===e&&(e="50%"),p[t?"top":"left"]=e}),t.each(p,function(e,i){f.hasOwnProperty(i)&&t.extend(g,f[i])}),p=p.top?t.extend(p,g):g,p=t.extend({top:"50%",left:"50%"},p),t(n.image).css({position:"absolute",top:m(p.top,"height",a),left:m(p.left,"width",s)}),n.show(),n.ready=!0,i.complete.call(n,n)},error:function(){Galleria.raise("Could not scale image: "+n.image.src)},timeout:1e3}),this}},t.extend(t.easing,{galleria:function(t,e,i,n,o){return(e/=o/2)<1?n/2*e*e*e+i:n/2*((e-=2)*e*e+2)+i},galleriaIn:function(t,e,i,n,o){return n*(e/=o)*e+i},galleriaOut:function(t,e,i,n,o){return-n*(e/=o)*(e-2)+i}}),t.fn.galleria=function(e){var i=this.selector;return t(this).length?this.each(function(){t.data(this,"galleria")||t.data(this,"galleria",(new Galleria).init(this,e))}):(t(function(){t(i).length?t(i).galleria(e):Galleria.utils.wait({until:function(){return t(i).length},success:function(){t(i).galleria(e)},error:function(){Galleria.raise('Init failed: Galleria could not find the element "'+i+'".')},timeout:5e3})}),this)}}(jQuery),/**
  * Klass.js - copyright @dedfat
  * version 1.0
  * https://github.com/ded/klass
  * Follow our software http://twitter.com/dedfat :)
  * MIT License
  */
!function(t,e){function i(t,e){function i(){}i[l]=this[l];var o=this,s=new i,a=h(t),r=a?t:this,c=a?{}:t,u=function(){this.initialize?this.initialize.apply(this,arguments):(e||a&&o.apply(this,arguments),r.apply(this,arguments))};return u.methods=function(t){return n(s,t,o),u[l]=s,this},u.methods.call(u,c).prototype.constructor=u,u.extend=arguments.callee,u[l].implement=u.statics=function(t,e){return t="string"==typeof t?function(){var i={};return i[t]=e,i}():t,n(this,t,o),this},u}function n(t,e,i){for(var n in e)e.hasOwnProperty(n)&&(t[n]=h(e[n])&&h(i[l][n])&&a.test(e[n])?o(n,e[n],i):e[n])}function o(t,e,i){return function(){var n=this.supr;this.supr=i[l][t];var o=e.apply(this,arguments);return this.supr=n,o}}function s(t){return i.call(h(t)?t:r,t,1)}var a=/xyz/.test(function(){})?/\bsupr\b/:/.*/,r=function(){},l="prototype",h=function(t){return typeof t===e};if("undefined"!=typeof module&&module.exports)module.exports=s;else{var c=t.klass;s.noConflict=function(){return t.klass=c,this},t.klass=s}}(this,"function"),// Copyright (c) 2012 by Code Computerlove (http://www.codecomputerlove.com)
function(t){Function.prototype.bind||(Function.prototype.bind=function(t){var e=[].slice,i=e.call(arguments,1),n=this,o=function(){},s=function(){return n.apply(this instanceof o?this:t||{},i.concat(e.call(arguments)))};return o.prototype=n.prototype,s.prototype=new o,s}),"undefined"==typeof t.Code&&(t.Code={}),t.Code.Util={registerNamespace:function(){var e,i,n,o,s,a,r,l=arguments,h=null;for(e=0,a=l.length;a>e;e++)for(n=l[e],o=n.split("."),s=o[0],"undefined"==typeof t[s]&&(t[s]={}),h=t[s],i=1,r=o.length;r>i;++i)h[o[i]]=h[o[i]]||{},h=h[o[i]]},coalesce:function(){var t,e;for(t=0,e=arguments.length;e>t;t++)if(!this.isNothing(arguments[t]))return arguments[t];return null},extend:function(t,e,i){var n;if(this.isNothing(i)&&(i=!0),t&&e&&this.isObject(e))for(n in e)this.objectHasProperty(e,n)&&(i?t[n]=e[n]:"undefined"==typeof t[n]&&(t[n]=e[n]))},clone:function(t){var e={};return this.extend(e,t),e},isObject:function(t){return t instanceof Object},isFunction:function(t){return"[object Function]"==={}.toString.call(t)},isArray:function(t){return t instanceof Array},isLikeArray:function(t){return"number"==typeof t.length},isNumber:function(t){return"number"==typeof t},isString:function(t){return"string"==typeof t},isNothing:function(t){return"undefined"==typeof t||null===t?!0:!1},swapArrayElements:function(t,e,i){var n=t[e];t[e]=t[i],t[i]=n},trim:function(t){return t.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},toCamelCase:function(t){return t.replace(/(\-[a-z])/g,function(t){return t.toUpperCase().replace("-","")})},toDashedCase:function(t){return t.replace(/([A-Z])/g,function(t){return"-"+t.toLowerCase()})},arrayIndexOf:function(t,e,i){var n,o,s,a;for(s=-1,n=0,o=e.length;o>n;n++)if(a=e[n],this.isNothing(i)){if(a===t){s=n;break}}else if(this.objectHasProperty(a,i)&&a[i]===t){s=n;break}return s},objectHasProperty:function(t,e){return t.hasOwnProperty?t.hasOwnProperty(e):"undefined"!=typeof t[e]}}}(window),// Copyright (c) 2012 by Code Computerlove (http://www.codecomputerlove.com)
function(t,e){e.Browser={ua:null,version:null,safari:null,webkit:null,opera:null,msie:null,chrome:null,mozilla:null,android:null,blackberry:null,iPad:null,iPhone:null,iPod:null,iOS:null,is3dSupported:null,isCSSTransformSupported:null,isTouchSupported:null,isGestureSupported:null,_detect:function(){this.ua=t.navigator.userAgent,this.version=this.ua.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[],this.safari=/Safari/gi.test(t.navigator.appVersion),this.webkit=/webkit/i.test(this.ua),this.opera=/opera/i.test(this.ua),this.msie=/msie/i.test(this.ua)&&!this.opera,this.chrome=/Chrome/i.test(this.ua),this.firefox=/Firefox/i.test(this.ua),this.fennec=/Fennec/i.test(this.ua),this.mozilla=/mozilla/i.test(this.ua)&&!/(compatible|webkit)/.test(this.ua),this.android=/android/i.test(this.ua),this.blackberry=/blackberry/i.test(this.ua),this.iOS=/iphone|ipod|ipad/gi.test(t.navigator.platform),this.iPad=/ipad/gi.test(t.navigator.platform),this.iPhone=/iphone/gi.test(t.navigator.platform),this.iPod=/ipod/gi.test(t.navigator.platform);var i=document.createElement("div");this.is3dSupported=!e.isNothing(i.style.WebkitPerspective),this.isCSSTransformSupported=!e.isNothing(i.style.WebkitTransform)||!e.isNothing(i.style.MozTransform)||!e.isNothing(i.style.transformProperty),this.isTouchSupported=this.isEventSupported("touchstart"),this.isGestureSupported=this.isEventSupported("gesturestart")},_eventTagNames:{select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"},isEventSupported:function(t){var i,n=document.createElement(this._eventTagNames[t]||"div");return t="on"+t,i=e.objectHasProperty(n,t),i||(n.setAttribute(t,"return;"),i="function"==typeof n[t]),n=null,i},isLandscape:function(){return e.DOM.windowWidth()>e.DOM.windowHeight()}},e.Browser._detect()}(window,window.Code.Util),// Copyright (c) 2012 by Code Computerlove (http://www.codecomputerlove.com)
function(t,e,i){i.extend(i,{Events:{add:function(t,i,n){e(t).bind(i,n)},remove:function(t,i,n){e(t).unbind(i,n)},fire:function(t,i){var n,o=Array.prototype.slice.call(arguments).splice(2);n="string"==typeof i?{type:i}:i,e(t).trigger(e.Event(n.type,n),o)},getMousePosition:function(t){var e={x:t.pageX,y:t.pageY};return e},getTouchEvent:function(t){return t.originalEvent},getWheelDelta:function(t){var e=0;return i.isNothing(t.wheelDelta)?i.isNothing(t.detail)||(e=-t.detail/3):e=t.wheelDelta/120,e},domReady:function(t){e(document).ready(t)}}})}(window,window.jQuery,window.Code.Util),// Copyright (c) 2012 by Code Computerlove (http://www.codecomputerlove.com)
function(t,e,i){i.extend(i,{DOM:{setData:function(t,e,n){if(i.isLikeArray(t)){var o,s;for(o=0,s=t.length;s>o;o++)i.DOM._setData(t[o],e,n)}else i.DOM._setData(t,e,n)},_setData:function(t,e,n){i.DOM.setAttribute(t,"data-"+e,n)},getData:function(t,e,n){return i.DOM.getAttribute(t,"data-"+e,n)},removeData:function(t,e){if(i.isLikeArray(t)){var n,o;for(n=0,o=t.length;o>n;n++)i.DOM._removeData(t[n],e)}else i.DOM._removeData(t,e)},_removeData:function(t,e){i.DOM.removeAttribute(t,"data-"+e)},isChildOf:function(t,e){if(e===t)return!1;for(;t&&t!==e;)t=t.parentNode;return t===e},find:function(n,o){i.isNothing(o)&&(o=t.document);var s,a,r=e(n,o),l=[];for(s=0,a=r.length;a>s;s++)l.push(r[s]);return l},createElement:function(t,i,n){var o=e("<"+t+"></"+t+">");return o.attr(i),o.append(n),o[0]},appendChild:function(t,i){e(i).append(t)},insertBefore:function(t,i){e(t).insertBefore(i)},appendText:function(t,i){e(i).text(t)},appendToBody:function(t){e("body").append(t)},removeChild:function(t){e(t).empty().remove()},removeChildren:function(t){e(t).empty()},hasAttribute:function(t,n){return!i.isNothing(e(t).attr(n))},getAttribute:function(t,n,o){var s=e(t).attr(n);return i.isNothing(s)&&!i.isNothing(o)&&(s=o),s},setAttribute:function(t,e,n){if(i.isLikeArray(t)){var o,s;for(o=0,s=t.length;s>o;o++)i.DOM._setAttribute(t[o],e,n)}else i.DOM._setAttribute(t,e,n)},_setAttribute:function(t,i,n){e(t).attr(i,n)},removeAttribute:function(t,e){if(i.isLikeArray(t)){var n,o;for(n=0,o=t.length;o>n;n++)i.DOM._removeAttribute(t[n],e)}else i.DOM._removeAttribute(t,e)},_removeAttribute:function(t,i){e(t).removeAttr(i)},addClass:function(t,e){if(i.isLikeArray(t)){var n,o;for(n=0,o=t.length;o>n;n++)i.DOM._addClass(t[n],e)}else i.DOM._addClass(t,e)},_addClass:function(t,i){e(t).addClass(i)},removeClass:function(t,e){if(i.isLikeArray(t)){var n,o;for(n=0,o=t.length;o>n;n++)i.DOM._removeClass(t[n],e)}else i.DOM._removeClass(t,e)},_removeClass:function(t,i){e(t).removeClass(i)},hasClass:function(t,i){e(t).hasClass(i)},setStyle:function(t,e,n){if(i.isLikeArray(t)){var o,s;for(o=0,s=t.length;s>o;o++)i.DOM._setStyle(t[o],e,n)}else i.DOM._setStyle(t,e,n)},_setStyle:function(t,n,o){var s;if(i.isObject(n))for(s in n)i.objectHasProperty(n,s)&&("width"===s?i.DOM.width(t,n[s]):"height"===s?i.DOM.height(t,n[s]):e(t).css(s,n[s]));else e(t).css(n,o)},getStyle:function(t,i){return e(t).css(i)},hide:function(t){if(i.isLikeArray(t)){var e,n;for(e=0,n=t.length;n>e;e++)i.DOM._hide(t[e])}else i.DOM._hide(t)},_hide:function(t){e(t).hide()},show:function(t){if(i.isLikeArray(t)){var e,n;for(e=0,n=t.length;n>e;e++)i.DOM._show(t[e])}else i.DOM._show(t)},_show:function(t){e(t).show()},width:function(t,n){return i.isNothing(n)||e(t).width(n),e(t).width()},outerWidth:function(t){return e(t).outerWidth()},height:function(t,n){return i.isNothing(n)||e(t).height(n),e(t).height()},outerHeight:function(t){return e(t).outerHeight()},documentWidth:function(){return e(document.documentElement).width()},documentHeight:function(){return e(document.documentElement).height()},documentOuterWidth:function(){return i.DOM.width(document.documentElement)},documentOuterHeight:function(){return i.DOM.outerHeight(document.documentElement)},bodyWidth:function(){return e(document.body).width()},bodyHeight:function(){return e(document.body).height()},bodyOuterWidth:function(){return i.DOM.outerWidth(document.body)},bodyOuterHeight:function(){return i.DOM.outerHeight(document.body)},windowWidth:function(){return t.innerWidth?t.innerWidth:e(t).width()},windowHeight:function(){return t.innerHeight?t.innerHeight:e(t).height()},windowScrollLeft:function(){return t.pageXOffset?t.pageXOffset:e(t).scrollLeft()},windowScrollTop:function(){return t.pageYOffset?t.pageYOffset:e(t).scrollTop()}}})}(window,window.jQuery,window.Code.Util),// Copyright (c) 2012 by Code Computerlove (http://www.codecomputerlove.com)
function(t,e){e.extend(e,{Animation:{_applyTransitionDelay:50,_transitionEndLabel:void 0!==t.document.documentElement.style.webkitTransition?"webkitTransitionEnd":"transitionend",_transitionEndHandler:null,_transitionPrefix:void 0!==t.document.documentElement.style.webkitTransition?"webkitTransition":void 0!==t.document.documentElement.style.MozTransition?"MozTransition":"transition",_transformLabel:void 0!==t.document.documentElement.style.webkitTransform?"webkitTransform":void 0!==t.document.documentElement.style.MozTransition?"MozTransform":"transform",_getTransitionEndHandler:function(){return e.isNothing(this._transitionEndHandler)&&(this._transitionEndHandler=this._onTransitionEnd.bind(this)),this._transitionEndHandler},stop:function(i){if(e.Browser.isCSSTransformSupported){var n=(i.style[this._transitionPrefix+"Property"],{});e.Events.remove(i,this._transitionEndLabel,this._getTransitionEndHandler()),e.isNothing(i.callbackLabel)&&delete i.callbackLabel,n[this._transitionPrefix+"Property"]="",n[this._transitionPrefix+"Duration"]="",n[this._transitionPrefix+"TimingFunction"]="",n[this._transitionPrefix+"Delay"]="",n[this._transformLabel]="",e.DOM.setStyle(i,n)}else e.isNothing(t.jQuery)||t.jQuery(i).stop(!0,!0)},fadeIn:function(i,n,o,s,a){if(a=e.coalesce(a,1),0>=a&&(a=1),0>=n&&(e.DOM.setStyle(i,"opacity",a),!e.isNothing(o)))return o(i),void 0;var r=e.DOM.getStyle(i,"opacity");r>=1&&e.DOM.setStyle(i,"opacity",0),e.Browser.isCSSTransformSupported?this._applyTransition(i,"opacity",a,n,o,s):e.isNothing(t.jQuery)||t.jQuery(i).fadeTo(n,a,o)},fadeTo:function(t,e,i,n,o){this.fadeIn(t,i,n,o,e)},fadeOut:function(i,n,o,s){return 0>=n&&(e.DOM.setStyle(i,"opacity",0),!e.isNothing(o))?(o(i),void 0):(e.Browser.isCSSTransformSupported?this._applyTransition(i,"opacity",0,n,o,s):t.jQuery(i).fadeTo(n,0,o),void 0)},slideBy:function(i,n,o,s,a,r){var l={};n=e.coalesce(n,0),o=e.coalesce(o,0),r=e.coalesce(r,"ease-out"),l[this._transitionPrefix+"Property"]="all",l[this._transitionPrefix+"Delay"]="0",0===s?(l[this._transitionPrefix+"Duration"]="",l[this._transitionPrefix+"TimingFunction"]=""):(l[this._transitionPrefix+"Duration"]=s+"ms",l[this._transitionPrefix+"TimingFunction"]=e.coalesce(r,"ease-out"),e.Events.add(i,this._transitionEndLabel,this._getTransitionEndHandler())),l[this._transformLabel]=e.Browser.is3dSupported?"translate3d("+n+"px, "+o+"px, 0px)":"translate("+n+"px, "+o+"px)",e.isNothing(a)||(i.cclallcallback=a),e.DOM.setStyle(i,l),0===s&&t.setTimeout(function(){this._leaveTransforms(i)}.bind(this),this._applyTransitionDelay)},resetTranslate:function(t){var i={};i[this._transformLabel]=i[this._transformLabel]=e.Browser.is3dSupported?"translate3d(0px, 0px, 0px)":"translate(0px, 0px)",e.DOM.setStyle(t,i)},_applyTransition:function(i,n,o,s,a,r){var l={};r=e.coalesce(r,"ease-in"),l[this._transitionPrefix+"Property"]=n,l[this._transitionPrefix+"Duration"]=s+"ms",l[this._transitionPrefix+"TimingFunction"]=r,l[this._transitionPrefix+"Delay"]="0",e.Events.add(i,this._transitionEndLabel,this._getTransitionEndHandler()),e.DOM.setStyle(i,l),e.isNothing(a)||(i["ccl"+n+"callback"]=a),t.setTimeout(function(){e.DOM.setStyle(i,n,o)},this._applyTransitionDelay)},_onTransitionEnd:function(t){e.Events.remove(t.currentTarget,this._transitionEndLabel,this._getTransitionEndHandler()),this._leaveTransforms(t.currentTarget)},_leaveTransforms:function(i){var n,o,s,a,r,l=i.style[this._transitionPrefix+"Property"],h=""!==l?"ccl"+l+"callback":"cclallcallback",c=e.coalesce(i.style.webkitTransform,i.style.MozTransform,i.style.transform),u=t.parseInt(e.DOM.getStyle(i,"left"),0),d=t.parseInt(e.DOM.getStyle(i,"top"),0),p={};""!==c&&(o=e.Browser.is3dSupported?c.match(/translate3d\((.*?)\)/):c.match(/translate\((.*?)\)/),e.isNothing(o)||(s=o[1].split(", "),a=t.parseInt(s[0],0),r=t.parseInt(s[1],0))),p[this._transitionPrefix+"Property"]="",p[this._transitionPrefix+"Duration"]="",p[this._transitionPrefix+"TimingFunction"]="",p[this._transitionPrefix+"Delay"]="",e.DOM.setStyle(i,p),t.setTimeout(function(){e.isNothing(s)||(p={},p[this._transformLabel]="",p.left=u+a+"px",p.top=d+r+"px",e.DOM.setStyle(i,p)),e.isNothing(i[h])||(n=i[h],delete i[h],n(i))}.bind(this),this._applyTransitionDelay)}}})}(window,window.Code.Util),// Copyright (c) 2012 by Code Computerlove (http://www.codecomputerlove.com)
function(t,e,i){i.registerNamespace("Code.Util.TouchElement"),i.TouchElement.EventTypes={onTouch:"CodeUtilTouchElementOnTouch"},i.TouchElement.ActionTypes={touchStart:"touchStart",touchMove:"touchMove",touchEnd:"touchEnd",touchMoveEnd:"touchMoveEnd",tap:"tap",doubleTap:"doubleTap",swipeLeft:"swipeLeft",swipeRight:"swipeRight",swipeUp:"swipeUp",swipeDown:"swipeDown",gestureStart:"gestureStart",gestureChange:"gestureChange",gestureEnd:"gestureEnd"}}(window,window.klass,window.Code.Util),// Copyright (c) 2012 by Code Computerlove (http://www.codecomputerlove.com)
function(t,e,i){i.registerNamespace("Code.Util.TouchElement"),i.TouchElement.TouchElementClass=e({el:null,captureSettings:null,touchStartPoint:null,touchEndPoint:null,touchStartTime:null,doubleTapTimeout:null,touchStartHandler:null,touchMoveHandler:null,touchEndHandler:null,mouseDownHandler:null,mouseMoveHandler:null,mouseUpHandler:null,mouseOutHandler:null,gestureStartHandler:null,gestureChangeHandler:null,gestureEndHandler:null,swipeThreshold:null,swipeTimeThreshold:null,doubleTapSpeed:null,dispose:function(){var t;this.removeEventHandlers();for(t in this)i.objectHasProperty(this,t)&&(this[t]=null)},initialize:function(t,e){this.el=t,this.captureSettings={swipe:!1,move:!1,gesture:!1,doubleTap:!1,preventDefaultTouchEvents:!0},i.extend(this.captureSettings,e),this.swipeThreshold=50,this.swipeTimeThreshold=250,this.doubleTapSpeed=250,this.touchStartPoint={x:0,y:0},this.touchEndPoint={x:0,y:0}},addEventHandlers:function(){i.isNothing(this.touchStartHandler)&&(this.touchStartHandler=this.onTouchStart.bind(this),this.touchMoveHandler=this.onTouchMove.bind(this),this.touchEndHandler=this.onTouchEnd.bind(this),this.mouseDownHandler=this.onMouseDown.bind(this),this.mouseMoveHandler=this.onMouseMove.bind(this),this.mouseUpHandler=this.onMouseUp.bind(this),this.mouseOutHandler=this.onMouseOut.bind(this),this.gestureStartHandler=this.onGestureStart.bind(this),this.gestureChangeHandler=this.onGestureChange.bind(this),this.gestureEndHandler=this.onGestureEnd.bind(this)),i.Events.add(this.el,"touchstart",this.touchStartHandler),this.captureSettings.move&&i.Events.add(this.el,"touchmove",this.touchMoveHandler),i.Events.add(this.el,"touchend",this.touchEndHandler),i.Events.add(this.el,"mousedown",this.mouseDownHandler),i.Browser.isGestureSupported&&this.captureSettings.gesture&&(i.Events.add(this.el,"gesturestart",this.gestureStartHandler),i.Events.add(this.el,"gesturechange",this.gestureChangeHandler),i.Events.add(this.el,"gestureend",this.gestureEndHandler))},removeEventHandlers:function(){i.Events.remove(this.el,"touchstart",this.touchStartHandler),this.captureSettings.move&&i.Events.remove(this.el,"touchmove",this.touchMoveHandler),i.Events.remove(this.el,"touchend",this.touchEndHandler),i.Events.remove(this.el,"mousedown",this.mouseDownHandler),i.Browser.isGestureSupported&&this.captureSettings.gesture&&(i.Events.remove(this.el,"gesturestart",this.gestureStartHandler),i.Events.remove(this.el,"gesturechange",this.gestureChangeHandler),i.Events.remove(this.el,"gestureend",this.gestureEndHandler))},getTouchPoint:function(t){return{x:t[0].pageX,y:t[0].pageY}},fireTouchEvent:function(e){var n,o,s=0,a=0,r=0;if(s=this.touchEndPoint.x-this.touchStartPoint.x,a=this.touchEndPoint.y-this.touchStartPoint.y,r=Math.sqrt(s*s+a*a),this.captureSettings.swipe&&(n=new Date,o=n-this.touchStartTime,o<=this.swipeTimeThreshold)){if(t.Math.abs(s)>=this.swipeThreshold)return i.Events.fire(this,{type:i.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:0>s?i.TouchElement.ActionTypes.swipeLeft:i.TouchElement.ActionTypes.swipeRight,targetEl:e.target,currentTargetEl:e.currentTarget}),void 0;if(t.Math.abs(a)>=this.swipeThreshold)return i.Events.fire(this,{type:i.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:0>a?i.TouchElement.ActionTypes.swipeUp:i.TouchElement.ActionTypes.swipeDown,targetEl:e.target,currentTargetEl:e.currentTarget}),void 0}return r>1?(i.Events.fire(this,{type:i.TouchElement.EventTypes.onTouch,target:this,action:i.TouchElement.ActionTypes.touchMoveEnd,point:this.touchEndPoint,targetEl:e.target,currentTargetEl:e.currentTarget}),void 0):this.captureSettings.doubleTap?i.isNothing(this.doubleTapTimeout)?(this.doubleTapTimeout=t.setTimeout(function(){this.doubleTapTimeout=null,i.Events.fire(this,{type:i.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:i.TouchElement.ActionTypes.tap,targetEl:e.target,currentTargetEl:e.currentTarget})}.bind(this),this.doubleTapSpeed),void 0):(t.clearTimeout(this.doubleTapTimeout),this.doubleTapTimeout=null,i.Events.fire(this,{type:i.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:i.TouchElement.ActionTypes.doubleTap,targetEl:e.target,currentTargetEl:e.currentTarget}),void 0):(i.Events.fire(this,{type:i.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:i.TouchElement.ActionTypes.tap,targetEl:e.target,currentTargetEl:e.currentTarget}),void 0)},onTouchStart:function(t){this.captureSettings.preventDefaultTouchEvents&&t.preventDefault(),i.Events.remove(this.el,"mousedown",this.mouseDownHandler);var e=i.Events.getTouchEvent(t),n=e.touches;return n.length>1&&this.captureSettings.gesture?(this.isGesture=!0,void 0):(this.touchStartTime=new Date,this.isGesture=!1,this.touchStartPoint=this.getTouchPoint(n),i.Events.fire(this,{type:i.TouchElement.EventTypes.onTouch,target:this,action:i.TouchElement.ActionTypes.touchStart,point:this.touchStartPoint,targetEl:t.target,currentTargetEl:t.currentTarget}),void 0)},onTouchMove:function(t){if(this.captureSettings.preventDefaultTouchEvents&&t.preventDefault(),!this.isGesture||!this.captureSettings.gesture){var e=i.Events.getTouchEvent(t),n=e.touches;i.Events.fire(this,{type:i.TouchElement.EventTypes.onTouch,target:this,action:i.TouchElement.ActionTypes.touchMove,point:this.getTouchPoint(n),targetEl:t.target,currentTargetEl:t.currentTarget})}},onTouchEnd:function(t){if(!this.isGesture||!this.captureSettings.gesture){this.captureSettings.preventDefaultTouchEvents&&t.preventDefault();var e=i.Events.getTouchEvent(t),n=i.isNothing(e.changedTouches)?e.touches:e.changedTouches;this.touchEndPoint=this.getTouchPoint(n),i.Events.fire(this,{type:i.TouchElement.EventTypes.onTouch,target:this,action:i.TouchElement.ActionTypes.touchEnd,point:this.touchEndPoint,targetEl:t.target,currentTargetEl:t.currentTarget}),this.fireTouchEvent(t)}},onMouseDown:function(t){t.preventDefault(),i.Events.remove(this.el,"touchstart",this.mouseDownHandler),i.Events.remove(this.el,"touchmove",this.touchMoveHandler),i.Events.remove(this.el,"touchend",this.touchEndHandler),this.captureSettings.move&&i.Events.add(this.el,"mousemove",this.mouseMoveHandler),i.Events.add(this.el,"mouseup",this.mouseUpHandler),i.Events.add(this.el,"mouseout",this.mouseOutHandler),this.touchStartTime=new Date,this.isGesture=!1,this.touchStartPoint=i.Events.getMousePosition(t),i.Events.fire(this,{type:i.TouchElement.EventTypes.onTouch,target:this,action:i.TouchElement.ActionTypes.touchStart,point:this.touchStartPoint,targetEl:t.target,currentTargetEl:t.currentTarget})},onMouseMove:function(t){t.preventDefault(),i.Events.fire(this,{type:i.TouchElement.EventTypes.onTouch,target:this,action:i.TouchElement.ActionTypes.touchMove,point:i.Events.getMousePosition(t),targetEl:t.target,currentTargetEl:t.currentTarget})},onMouseUp:function(t){t.preventDefault(),this.captureSettings.move&&i.Events.remove(this.el,"mousemove",this.mouseMoveHandler),i.Events.remove(this.el,"mouseup",this.mouseUpHandler),i.Events.remove(this.el,"mouseout",this.mouseOutHandler),this.touchEndPoint=i.Events.getMousePosition(t),i.Events.fire(this,{type:i.TouchElement.EventTypes.onTouch,target:this,action:i.TouchElement.ActionTypes.touchEnd,point:this.touchEndPoint,targetEl:t.target,currentTargetEl:t.currentTarget}),this.fireTouchEvent(t)},onMouseOut:function(t){var e=t.relatedTarget;this.el===e||i.DOM.isChildOf(e,this.el)||(t.preventDefault(),this.captureSettings.move&&i.Events.remove(this.el,"mousemove",this.mouseMoveHandler),i.Events.remove(this.el,"mouseup",this.mouseUpHandler),i.Events.remove(this.el,"mouseout",this.mouseOutHandler),this.touchEndPoint=i.Events.getMousePosition(t),i.Events.fire(this,{type:i.TouchElement.EventTypes.onTouch,target:this,action:i.TouchElement.ActionTypes.touchEnd,point:this.touchEndPoint,targetEl:t.target,currentTargetEl:t.currentTarget}),this.fireTouchEvent(t))},onGestureStart:function(t){t.preventDefault();var e=i.Events.getTouchEvent(t);i.Events.fire(this,{type:i.TouchElement.EventTypes.onTouch,target:this,action:i.TouchElement.ActionTypes.gestureStart,scale:e.scale,rotation:e.rotation,targetEl:t.target,currentTargetEl:t.currentTarget})},onGestureChange:function(t){t.preventDefault();var e=i.Events.getTouchEvent(t);i.Events.fire(this,{type:i.TouchElement.EventTypes.onTouch,target:this,action:i.TouchElement.ActionTypes.gestureChange,scale:e.scale,rotation:e.rotation,targetEl:t.target,currentTargetEl:t.currentTarget})},onGestureEnd:function(t){t.preventDefault();var e=i.Events.getTouchEvent(t);i.Events.fire(this,{type:i.TouchElement.EventTypes.onTouch,target:this,action:i.TouchElement.ActionTypes.gestureEnd,scale:e.scale,rotation:e.rotation,targetEl:t.target,currentTargetEl:t.currentTarget})}})}(window,window.klass,window.Code.Util),// Copyright (c) 2012 by Code Computerlove (http://www.codecomputerlove.com)
function(t,e,i){i.registerNamespace("Code.PhotoSwipe.Image");var n=t.Code.PhotoSwipe;n.Image.EventTypes={onLoad:"onLoad",onError:"onError"}}(window,window.klass,window.Code.Util),// Copyright (c) 2012 by Code Computerlove (http://www.codecomputerlove.com)
function(t,e,i){i.registerNamespace("Code.PhotoSwipe.Image");var n=t.Code.PhotoSwipe;n.Image.ImageClass=e({refObj:null,imageEl:null,src:null,caption:null,metaData:null,imageLoadHandler:null,imageErrorHandler:null,dispose:function(){var t;this.shrinkImage();for(t in this)i.objectHasProperty(this,t)&&(this[t]=null)},initialize:function(e,i,n,o){this.refObj=e,this.originalSrc=i,this.src=i,this.caption=n,this.metaData=o,this.imageEl=new t.Image,this.imageLoadHandler=this.onImageLoad.bind(this),this.imageErrorHandler=this.onImageError.bind(this)},load:function(){return this.imageEl.originalSrc=i.coalesce(this.imageEl.originalSrc,""),this.imageEl.originalSrc===this.src?(this.imageEl.isError?i.Events.fire(this,{type:n.Image.EventTypes.onError,target:this}):i.Events.fire(this,{type:n.Image.EventTypes.onLoad,target:this}),void 0):(this.imageEl.isError=!1,this.imageEl.isLoading=!0,this.imageEl.naturalWidth=null,this.imageEl.naturalHeight=null,this.imageEl.isLandscape=!1,this.imageEl.onload=this.imageLoadHandler,this.imageEl.onerror=this.imageErrorHandler,this.imageEl.onabort=this.imageErrorHandler,this.imageEl.originalSrc=this.src,this.imageEl.src=this.src,void 0)},shrinkImage:function(){i.isNothing(this.imageEl)||this.imageEl.src.indexOf(this.src)>-1&&(this.imageEl.src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=",i.isNothing(this.imageEl.parentNode)||i.DOM.removeChild(this.imageEl,this.imageEl.parentNode))},onImageLoad:function(){this.imageEl.onload=null,this.imageEl.naturalWidth=i.coalesce(this.imageEl.naturalWidth,this.imageEl.width),this.imageEl.naturalHeight=i.coalesce(this.imageEl.naturalHeight,this.imageEl.height),this.imageEl.isLandscape=this.imageEl.naturalWidth>this.imageEl.naturalHeight,this.imageEl.isLoading=!1,i.Events.fire(this,{type:n.Image.EventTypes.onLoad,target:this})},onImageError:function(){this.imageEl.onload=null,this.imageEl.onerror=null,this.imageEl.onabort=null,this.imageEl.isLoading=!1,this.imageEl.isError=!0,i.Events.fire(this,{type:n.Image.EventTypes.onError,target:this})}})}(window,window.klass,window.Code.Util),// Copyright (c) 2012 by Code Computerlove (http://www.codecomputerlove.com)
function(t,e,i){i.registerNamespace("Code.PhotoSwipe.Cache");var n=t.Code.PhotoSwipe;n.Cache.Mode={normal:"normal",aggressive:"aggressive"},n.Cache.Functions={getImageSource:function(t){return t.href},getImageCaption:function(t){if("IMG"===t.nodeName)return i.DOM.getAttribute(t,"alt");var e,n,o;for(e=0,n=t.childNodes.length;n>e;e++)if(o=t.childNodes[e],"IMG"===t.childNodes[e].nodeName)return i.DOM.getAttribute(o,"alt")},getImageMetaData:function(){return{}}}}(window,window.klass,window.Code.Util),// Copyright (c) 2012 by Code Computerlove (http://www.codecomputerlove.com)
function(t,e,i){i.registerNamespace("Code.PhotoSwipe.Cache");var n=t.Code.PhotoSwipe;n.Cache.CacheClass=e({images:null,settings:null,dispose:function(){var t,e,n;if(!i.isNothing(this.images)){for(e=0,n=this.images.length;n>e;e++)this.images[e].dispose();this.images.length=0}for(t in this)i.objectHasProperty(this,t)&&(this[t]=null)},initialize:function(t,e){var i,o,s,a,r,l;for(this.settings=e,this.images=[],i=0,o=t.length;o>i;i++)s=t[i],a=this.settings.getImageSource(s),r=this.settings.getImageCaption(s),l=this.settings.getImageMetaData(s),this.images.push(new n.Image.ImageClass(s,a,r,l))},getImages:function(t){var e,o,s,a=[];for(e=0,o=t.length;o>e;e++)s=this.images[t[e]],this.settings.cacheMode===n.Cache.Mode.aggressive&&(s.cacheDoNotShrink=!0),a.push(s);if(this.settings.cacheMode===n.Cache.Mode.aggressive)for(e=0,o=this.images.length;o>e;e++)s=this.images[e],i.objectHasProperty(s,"cacheDoNotShrink")?delete s.cacheDoNotShrink:s.shrinkImage();return a}})}(window,window.klass,window.Code.Util,window.Code.PhotoSwipe.Image),// Copyright (c) 2012 by Code Computerlove (http://www.codecomputerlove.com)
function(t,e,i){i.registerNamespace("Code.PhotoSwipe.DocumentOverlay");var n=t.Code.PhotoSwipe;n.DocumentOverlay.CssClasses={documentOverlay:"ps-document-overlay"}}(window,window.klass,window.Code.Util),// Copyright (c) 2012 by Code Computerlove (http://www.codecomputerlove.com)
function(t,e,i){i.registerNamespace("Code.PhotoSwipe.DocumentOverlay");var n=t.Code.PhotoSwipe;n.DocumentOverlay.DocumentOverlayClass=e({el:null,settings:null,initialBodyHeight:null,dispose:function(){var t;i.Animation.stop(this.el),i.DOM.removeChild(this.el,this.el.parentNode);for(t in this)i.objectHasProperty(this,t)&&(this[t]=null)},initialize:function(e){this.settings=e,this.el=i.DOM.createElement("div",{"class":n.DocumentOverlay.CssClasses.documentOverlay},""),i.DOM.setStyle(this.el,{display:"block",position:"absolute",left:0,top:0,zIndex:this.settings.zIndex}),i.DOM.hide(this.el),this.settings.target===t?i.DOM.appendToBody(this.el):i.DOM.appendChild(this.el,this.settings.target),i.Animation.resetTranslate(this.el),this.initialBodyHeight=i.DOM.bodyOuterHeight()},resetPosition:function(){var e,n,o;this.settings.target===t?(e=i.DOM.windowWidth(),n=2*i.DOM.bodyOuterHeight(),o=this.settings.jQueryMobile?i.DOM.windowScrollTop()+"px":"0px",1>n&&(n=this.initialBodyHeight),i.DOM.windowHeight()>n&&(n=i.DOM.windowHeight())):(e=i.DOM.width(this.settings.target),n=i.DOM.height(this.settings.target),o="0px"),i.DOM.setStyle(this.el,{width:e,height:n,top:o})},fadeIn:function(t,e){this.resetPosition(),i.DOM.setStyle(this.el,"opacity",0),i.DOM.show(this.el),i.Animation.fadeIn(this.el,t,e)}})}(window,window.klass,window.Code.Util),// Copyright (c) 2012 by Code Computerlove (http://www.codecomputerlove.com)
function(t,e,i){i.registerNamespace("Code.PhotoSwipe.Carousel");var n=t.Code.PhotoSwipe;n.Carousel.EventTypes={onSlideByEnd:"PhotoSwipeCarouselOnSlideByEnd",onSlideshowStart:"PhotoSwipeCarouselOnSlideshowStart",onSlideshowStop:"PhotoSwipeCarouselOnSlideshowStop"},n.Carousel.CssClasses={carousel:"ps-carousel",content:"ps-carousel-content",item:"ps-carousel-item",itemLoading:"ps-carousel-item-loading",itemError:"ps-carousel-item-error"},n.Carousel.SlideByAction={previous:"previous",current:"current",next:"next"}}(window,window.klass,window.Code.Util),// Copyright (c) 2012 by Code Computerlove (http://www.codecomputerlove.com)
function(t,e,i){i.registerNamespace("Code.PhotoSwipe.Carousel");var n=t.Code.PhotoSwipe;n.Carousel.CarouselClass=e({el:null,contentEl:null,settings:null,cache:null,slideByEndHandler:null,currentCacheIndex:null,isSliding:null,isSlideshowActive:null,lastSlideByAction:null,touchStartPoint:null,touchStartPosition:null,imageLoadHandler:null,imageErrorHandler:null,slideshowTimeout:null,dispose:function(){var t,e,o;for(e=0,o=this.cache.images.length;o>e;e++)i.Events.remove(this.cache.images[e],n.Image.EventTypes.onLoad,this.imageLoadHandler),i.Events.remove(this.cache.images[e],n.Image.EventTypes.onError,this.imageErrorHandler);this.stopSlideshow(),i.Animation.stop(this.el),i.DOM.removeChild(this.el,this.el.parentNode);for(t in this)i.objectHasProperty(this,t)&&(this[t]=null)},initialize:function(e,o){var s,a,r;for(this.cache=e,this.settings=o,this.slideByEndHandler=this.onSlideByEnd.bind(this),this.imageLoadHandler=this.onImageLoad.bind(this),this.imageErrorHandler=this.onImageError.bind(this),this.currentCacheIndex=0,this.isSliding=!1,this.isSlideshowActive=!1,this.cache.images.length<3&&(this.settings.loop=!1),this.el=i.DOM.createElement("div",{"class":n.Carousel.CssClasses.carousel},""),i.DOM.setStyle(this.el,{display:"block",position:"absolute",left:0,top:0,overflow:"hidden",zIndex:this.settings.zIndex}),i.DOM.hide(this.el),this.contentEl=i.DOM.createElement("div",{"class":n.Carousel.CssClasses.content},""),i.DOM.setStyle(this.contentEl,{display:"block",position:"absolute",left:0,top:0}),i.DOM.appendChild(this.contentEl,this.el),a=e.images.length<3?e.images.length:3,s=0;a>s;s++)r=i.DOM.createElement("div",{"class":n.Carousel.CssClasses.item+" "+n.Carousel.CssClasses.item+"-"+s},""),i.DOM.setAttribute(r,"style","float: left;"),i.DOM.setStyle(r,{display:"block",position:"relative",left:0,top:0,overflow:"hidden"}),this.settings.margin>0&&i.DOM.setStyle(r,{marginRight:this.settings.margin+"px"}),i.DOM.appendChild(r,this.contentEl);this.settings.target===t?i.DOM.appendToBody(this.el):i.DOM.appendChild(this.el,this.settings.target)},resetPosition:function(){var e,o,s,a,r,l,h,c,u,d;for(this.settings.target===t?(e=i.DOM.windowWidth(),o=i.DOM.windowHeight(),s=i.DOM.windowScrollTop()+"px"):(e=i.DOM.width(this.settings.target),o=i.DOM.height(this.settings.target),s="0px"),a=this.settings.margin>0?e+this.settings.margin:e,r=i.DOM.find("."+n.Carousel.CssClasses.item,this.contentEl),l=a*r.length,i.DOM.setStyle(this.el,{top:s,width:e,height:o}),i.DOM.setStyle(this.contentEl,{width:l,height:o}),h=0,c=r.length;c>h;h++)u=r[h],i.DOM.setStyle(u,{width:e,height:o}),d=i.DOM.find("img",u)[0],i.isNothing(d)||this.resetImagePosition(d);this.setContentLeftPosition()},resetImagePosition:function(t){if(!i.isNothing(t)){var e,n,o,s,a,r=(i.DOM.getAttribute(t,"src"),i.DOM.width(this.el)),l=i.DOM.height(this.el);"fitNoUpscale"===this.settings.imageScaleMethod?(n=t.naturalWidth,o=t.naturalHeight,n>r&&(e=r/n,n=Math.round(n*e),o=Math.round(o*e)),o>l&&(e=l/o,o=Math.round(o*e),n=Math.round(n*e))):(e=t.isLandscape?r/t.naturalWidth:l/t.naturalHeight,n=Math.round(t.naturalWidth*e),o=Math.round(t.naturalHeight*e),"zoom"===this.settings.imageScaleMethod?(e=1,l>o?e=l/o:r>n&&(e=r/n),1!==e&&(n=Math.round(n*e),o=Math.round(o*e))):"fit"===this.settings.imageScaleMethod&&(e=1,n>r?e=r/n:o>l&&(e=l/o),1!==e&&(n=Math.round(n*e),o=Math.round(o*e)))),s=Math.round((l-o)/2)+"px",a=Math.round((r-n)/2)+"px",i.DOM.setStyle(t,{position:"absolute",width:n,height:o,top:s,left:a,display:"block"})}},setContentLeftPosition:function(){var e,n,o;e=this.settings.target===t?i.DOM.windowWidth():i.DOM.width(this.settings.target),n=this.getItemEls(),o=0,this.settings.loop?o=-1*(e+this.settings.margin):this.currentCacheIndex===this.cache.images.length-1?o=(n.length-1)*(e+this.settings.margin)*-1:this.currentCacheIndex>0&&(o=-1*(e+this.settings.margin)),i.DOM.setStyle(this.contentEl,{left:o+"px"})},show:function(t){this.currentCacheIndex=t,this.resetPosition(),this.setImages(!1),i.DOM.show(this.el),i.Animation.resetTranslate(this.contentEl);var e,o,s=this.getItemEls();for(e=0,o=s.length;o>e;e++)i.Animation.resetTranslate(s[e]);i.Events.fire(this,{type:n.Carousel.EventTypes.onSlideByEnd,target:this,action:n.Carousel.SlideByAction.current,cacheIndex:this.currentCacheIndex})},setImages:function(t){var e,i=this.getItemEls(),n=this.currentCacheIndex+1,o=this.currentCacheIndex-1;this.settings.loop?(n>this.cache.images.length-1&&(n=0),0>o&&(o=this.cache.images.length-1),e=this.cache.getImages([o,this.currentCacheIndex,n]),t||this.addCacheImageToItemEl(e[1],i[1]),this.addCacheImageToItemEl(e[2],i[2]),this.addCacheImageToItemEl(e[0],i[0])):1===i.length?t||(e=this.cache.getImages([this.currentCacheIndex]),this.addCacheImageToItemEl(e[0],i[0])):2===i.length?0===this.currentCacheIndex?(e=this.cache.getImages([this.currentCacheIndex,this.currentCacheIndex+1]),t||this.addCacheImageToItemEl(e[0],i[0]),this.addCacheImageToItemEl(e[1],i[1])):(e=this.cache.getImages([this.currentCacheIndex-1,this.currentCacheIndex]),t||this.addCacheImageToItemEl(e[1],i[1]),this.addCacheImageToItemEl(e[0],i[0])):0===this.currentCacheIndex?(e=this.cache.getImages([this.currentCacheIndex,this.currentCacheIndex+1,this.currentCacheIndex+2]),t||this.addCacheImageToItemEl(e[0],i[0]),this.addCacheImageToItemEl(e[1],i[1]),this.addCacheImageToItemEl(e[2],i[2])):this.currentCacheIndex===this.cache.images.length-1?(e=this.cache.getImages([this.currentCacheIndex-2,this.currentCacheIndex-1,this.currentCacheIndex]),t||this.addCacheImageToItemEl(e[2],i[2]),this.addCacheImageToItemEl(e[1],i[1]),this.addCacheImageToItemEl(e[0],i[0])):(e=this.cache.getImages([this.currentCacheIndex-1,this.currentCacheIndex,this.currentCacheIndex+1]),t||this.addCacheImageToItemEl(e[1],i[1]),this.addCacheImageToItemEl(e[2],i[2]),this.addCacheImageToItemEl(e[0],i[0]))},addCacheImageToItemEl:function(t,e){i.DOM.removeClass(e,n.Carousel.CssClasses.itemError),i.DOM.addClass(e,n.Carousel.CssClasses.itemLoading),i.DOM.removeChildren(e),i.DOM.setStyle(t.imageEl,{display:"none"}),i.DOM.appendChild(t.imageEl,e),i.Animation.resetTranslate(t.imageEl),i.Events.add(t,n.Image.EventTypes.onLoad,this.imageLoadHandler),i.Events.add(t,n.Image.EventTypes.onError,this.imageErrorHandler),t.load()},slideCarousel:function(e,o,s){if(!this.isSliding){var a,r,l;if(a=this.settings.target===t?i.DOM.windowWidth()+this.settings.margin:i.DOM.width(this.settings.target)+this.settings.margin,s=i.coalesce(s,this.settings.slideSpeed),!(t.Math.abs(r)<1)){switch(o){case i.TouchElement.ActionTypes.swipeLeft:l=-1*a;break;case i.TouchElement.ActionTypes.swipeRight:l=a;break;default:r=e.x-this.touchStartPoint.x,l=t.Math.abs(r)>a/2?r>0?a:-1*a:0}this.lastSlideByAction=0>l?n.Carousel.SlideByAction.next:l>0?n.Carousel.SlideByAction.previous:n.Carousel.SlideByAction.current,this.settings.loop||(this.lastSlideByAction===n.Carousel.SlideByAction.previous&&0===this.currentCacheIndex||this.lastSlideByAction===n.Carousel.SlideByAction.next&&this.currentCacheIndex===this.cache.images.length-1)&&(l=0,this.lastSlideByAction=n.Carousel.SlideByAction.current),this.isSliding=!0,this.doSlideCarousel(l,s)}}},moveCarousel:function(t){this.isSliding||this.settings.enableDrag&&this.doMoveCarousel(t.x-this.touchStartPoint.x)},getItemEls:function(){return i.DOM.find("."+n.Carousel.CssClasses.item,this.contentEl)},previous:function(){this.stopSlideshow(),this.slideCarousel({x:0,y:0},i.TouchElement.ActionTypes.swipeRight,this.settings.nextPreviousSlideSpeed)},next:function(){this.stopSlideshow(),this.slideCarousel({x:0,y:0},i.TouchElement.ActionTypes.swipeLeft,this.settings.nextPreviousSlideSpeed)},slideshowNext:function(){this.slideCarousel({x:0,y:0},i.TouchElement.ActionTypes.swipeLeft)},startSlideshow:function(){this.stopSlideshow(),this.isSlideshowActive=!0,this.slideshowTimeout=t.setTimeout(this.slideshowNext.bind(this),this.settings.slideshowDelay),i.Events.fire(this,{type:n.Carousel.EventTypes.onSlideshowStart,target:this})},stopSlideshow:function(){i.isNothing(this.slideshowTimeout)||(t.clearTimeout(this.slideshowTimeout),this.slideshowTimeout=null,this.isSlideshowActive=!1,i.Events.fire(this,{type:n.Carousel.EventTypes.onSlideshowStop,target:this}))},onSlideByEnd:function(){if(!i.isNothing(this.isSliding)){var t=this.getItemEls();this.isSliding=!1,this.lastSlideByAction===n.Carousel.SlideByAction.next?this.currentCacheIndex=this.currentCacheIndex+1:this.lastSlideByAction===n.Carousel.SlideByAction.previous&&(this.currentCacheIndex=this.currentCacheIndex-1),this.settings.loop?(this.lastSlideByAction===n.Carousel.SlideByAction.next?i.DOM.appendChild(t[0],this.contentEl):this.lastSlideByAction===n.Carousel.SlideByAction.previous&&i.DOM.insertBefore(t[t.length-1],t[0],this.contentEl),this.currentCacheIndex<0?this.currentCacheIndex=this.cache.images.length-1:this.currentCacheIndex===this.cache.images.length&&(this.currentCacheIndex=0)):this.cache.images.length>3&&(this.currentCacheIndex>1&&this.currentCacheIndex<this.cache.images.length-2?this.lastSlideByAction===n.Carousel.SlideByAction.next?i.DOM.appendChild(t[0],this.contentEl):this.lastSlideByAction===n.Carousel.SlideByAction.previous&&i.DOM.insertBefore(t[t.length-1],t[0],this.contentEl):1===this.currentCacheIndex?this.lastSlideByAction===n.Carousel.SlideByAction.previous&&i.DOM.insertBefore(t[t.length-1],t[0],this.contentEl):this.currentCacheIndex===this.cache.images.length-2&&this.lastSlideByAction===n.Carousel.SlideByAction.next&&i.DOM.appendChild(t[0],this.contentEl)),this.lastSlideByAction!==n.Carousel.SlideByAction.current&&(this.setContentLeftPosition(),this.setImages(!0)),i.Events.fire(this,{type:n.Carousel.EventTypes.onSlideByEnd,target:this,action:this.lastSlideByAction,cacheIndex:this.currentCacheIndex}),this.isSlideshowActive&&(this.lastSlideByAction!==n.Carousel.SlideByAction.current?this.startSlideshow():this.stopSlideshow())}},onTouch:function(e,n){switch(this.stopSlideshow(),e){case i.TouchElement.ActionTypes.touchStart:this.touchStartPoint=n,this.touchStartPosition={x:t.parseInt(i.DOM.getStyle(this.contentEl,"left"),0),y:t.parseInt(i.DOM.getStyle(this.contentEl,"top"),0)};break;case i.TouchElement.ActionTypes.touchMove:this.moveCarousel(n);break;case i.TouchElement.ActionTypes.touchMoveEnd:case i.TouchElement.ActionTypes.swipeLeft:case i.TouchElement.ActionTypes.swipeRight:this.slideCarousel(n,e);break;case i.TouchElement.ActionTypes.tap:break;case i.TouchElement.ActionTypes.doubleTap:}},onImageLoad:function(t){var e=t.target;i.isNothing(e.imageEl.parentNode)||(i.DOM.removeClass(e.imageEl.parentNode,n.Carousel.CssClasses.itemLoading),this.resetImagePosition(e.imageEl)),i.Events.remove(e,n.Image.EventTypes.onLoad,this.imageLoadHandler),i.Events.remove(e,n.Image.EventTypes.onError,this.imageErrorHandler)},onImageError:function(t){var e=t.target;i.isNothing(e.imageEl.parentNode)||(i.DOM.removeClass(e.imageEl.parentNode,n.Carousel.CssClasses.itemLoading),i.DOM.addClass(e.imageEl.parentNode,n.Carousel.CssClasses.itemError)),i.Events.remove(e,n.Image.EventTypes.onLoad,this.imageLoadHandler),i.Events.remove(e,n.Image.EventTypes.onError,this.imageErrorHandler)}})}(window,window.klass,window.Code.Util),// Copyright (c) 2012 by Code Computerlove (http://www.codecomputerlove.com)
function(t,e,i){i.registerNamespace("Code.PhotoSwipe.Carousel");var n=t.Code.PhotoSwipe;n.Carousel.CarouselClass=n.Carousel.CarouselClass.extend({getStartingPos:function(){var e=this.touchStartPosition;return i.isNothing(e)&&(e={x:t.parseInt(i.DOM.getStyle(this.contentEl,"left"),0),y:t.parseInt(i.DOM.getStyle(this.contentEl,"top"),0)}),e},doMoveCarousel:function(e){var n;i.Browser.isCSSTransformSupported?(n={},n[i.Animation._transitionPrefix+"Property"]="all",n[i.Animation._transitionPrefix+"Duration"]="",n[i.Animation._transitionPrefix+"TimingFunction"]="",n[i.Animation._transitionPrefix+"Delay"]="0",n[i.Animation._transformLabel]=i.Browser.is3dSupported?"translate3d("+e+"px, 0px, 0px)":"translate("+e+"px, 0px)",i.DOM.setStyle(this.contentEl,n)):i.isNothing(t.jQuery)||t.jQuery(this.contentEl).stop().css("left",this.getStartingPos().x+e+"px")},doSlideCarousel:function(e,n){var o,s;if(0>=n)return this.slideByEndHandler(),void 0;if(i.Browser.isCSSTransformSupported){if(s=i.coalesce(this.contentEl.style.webkitTransform,this.contentEl.style.MozTransform,this.contentEl.style.transform,""),0===s.indexOf("translate3d("+e))return this.slideByEndHandler(),void 0;if(0===s.indexOf("translate("+e))return this.slideByEndHandler(),void 0;i.Animation.slideBy(this.contentEl,e,0,n,this.slideByEndHandler,this.settings.slideTimingFunction)}else i.isNothing(t.jQuery)||(o={left:this.getStartingPos().x+e+"px"},"ease-out"===this.settings.animationTimingFunction&&(this.settings.animationTimingFunction="easeOutQuad"),i.isNothing(t.jQuery.easing[this.settings.animationTimingFunction])&&(this.settings.animationTimingFunction="linear"),t.jQuery(this.contentEl).animate(o,this.settings.slideSpeed,this.settings.animationTimingFunction,this.slideByEndHandler))}})}(window,window.klass,window.Code.Util,window.Code.PhotoSwipe.TouchElement),// Copyright (c) 2012 by Code Computerlove (http://www.codecomputerlove.com)
function(t,e,i){i.registerNamespace("Code.PhotoSwipe.Toolbar");var n=t.Code.PhotoSwipe;n.Toolbar.CssClasses={toolbar:"ps-toolbar",toolbarContent:"ps-toolbar-content",toolbarTop:"ps-toolbar-top",caption:"ps-caption",captionBottom:"ps-caption-bottom",captionContent:"ps-caption-content",close:"ps-toolbar-close",play:"ps-toolbar-play",previous:"ps-toolbar-previous",previousDisabled:"ps-toolbar-previous-disabled",next:"ps-toolbar-next",nextDisabled:"ps-toolbar-next-disabled"},n.Toolbar.ToolbarAction={close:"close",play:"play",next:"next",previous:"previous",none:"none"},n.Toolbar.EventTypes={onTap:"PhotoSwipeToolbarOnClick",onBeforeShow:"PhotoSwipeToolbarOnBeforeShow",onShow:"PhotoSwipeToolbarOnShow",onBeforeHide:"PhotoSwipeToolbarOnBeforeHide",onHide:"PhotoSwipeToolbarOnHide"},n.Toolbar.getToolbar=function(){return'<div class="'+n.Toolbar.CssClasses.close+'"><div class="'+n.Toolbar.CssClasses.toolbarContent+'"></div></div><div class="'+n.Toolbar.CssClasses.play+'"><div class="'+n.Toolbar.CssClasses.toolbarContent+'"></div></div><div class="'+n.Toolbar.CssClasses.previous+'"><div class="'+n.Toolbar.CssClasses.toolbarContent+'"></div></div><div class="'+n.Toolbar.CssClasses.next+'"><div class="'+n.Toolbar.CssClasses.toolbarContent+'"></div></div>'}}(window,window.klass,window.Code.Util),// Copyright (c) 2012 by Code Computerlove (http://www.codecomputerlove.com)
function(t,e,i){i.registerNamespace("Code.PhotoSwipe.Toolbar");var n=t.Code.PhotoSwipe;n.Toolbar.ToolbarClass=e({toolbarEl:null,closeEl:null,playEl:null,previousEl:null,nextEl:null,captionEl:null,captionContentEl:null,currentCaption:null,settings:null,cache:null,timeout:null,isVisible:null,fadeOutHandler:null,touchStartHandler:null,touchMoveHandler:null,clickHandler:null,dispose:function(){var t;this.clearTimeout(),this.removeEventHandlers(),i.Animation.stop(this.toolbarEl),i.Animation.stop(this.captionEl),i.DOM.removeChild(this.toolbarEl,this.toolbarEl.parentNode),i.DOM.removeChild(this.captionEl,this.captionEl.parentNode);for(t in this)i.objectHasProperty(this,t)&&(this[t]=null)},initialize:function(e,o){var s;this.settings=o,this.cache=e,this.isVisible=!1,this.fadeOutHandler=this.onFadeOut.bind(this),this.touchStartHandler=this.onTouchStart.bind(this),this.touchMoveHandler=this.onTouchMove.bind(this),this.clickHandler=this.onClick.bind(this),s=n.Toolbar.CssClasses.toolbar,this.settings.captionAndToolbarFlipPosition&&(s=s+" "+n.Toolbar.CssClasses.toolbarTop),this.toolbarEl=i.DOM.createElement("div",{"class":s},this.settings.getToolbar()),i.DOM.setStyle(this.toolbarEl,{left:0,position:"absolute",overflow:"hidden",zIndex:this.settings.zIndex}),this.settings.target===t?i.DOM.appendToBody(this.toolbarEl):i.DOM.appendChild(this.toolbarEl,this.settings.target),i.DOM.hide(this.toolbarEl),this.closeEl=i.DOM.find("."+n.Toolbar.CssClasses.close,this.toolbarEl)[0],this.settings.preventHide&&!i.isNothing(this.closeEl)&&i.DOM.hide(this.closeEl),this.playEl=i.DOM.find("."+n.Toolbar.CssClasses.play,this.toolbarEl)[0],this.settings.preventSlideshow&&!i.isNothing(this.playEl)&&i.DOM.hide(this.playEl),this.nextEl=i.DOM.find("."+n.Toolbar.CssClasses.next,this.toolbarEl)[0],this.previousEl=i.DOM.find("."+n.Toolbar.CssClasses.previous,this.toolbarEl)[0],s=n.Toolbar.CssClasses.caption,this.settings.captionAndToolbarFlipPosition&&(s=s+" "+n.Toolbar.CssClasses.captionBottom),this.captionEl=i.DOM.createElement("div",{"class":s},""),i.DOM.setStyle(this.captionEl,{left:0,position:"absolute",overflow:"hidden",zIndex:this.settings.zIndex}),this.settings.target===t?i.DOM.appendToBody(this.captionEl):i.DOM.appendChild(this.captionEl,this.settings.target),i.DOM.hide(this.captionEl),this.captionContentEl=i.DOM.createElement("div",{"class":n.Toolbar.CssClasses.captionContent},""),i.DOM.appendChild(this.captionContentEl,this.captionEl),this.addEventHandlers()},resetPosition:function(){var e,n,o;this.settings.target===t?(this.settings.captionAndToolbarFlipPosition?(n=i.DOM.windowScrollTop(),o=i.DOM.windowScrollTop()+i.DOM.windowHeight()-i.DOM.height(this.captionEl)):(n=i.DOM.windowScrollTop()+i.DOM.windowHeight()-i.DOM.height(this.toolbarEl),o=i.DOM.windowScrollTop()),e=i.DOM.windowWidth()):(this.settings.captionAndToolbarFlipPosition?(n="0",o=i.DOM.height(this.settings.target)-i.DOM.height(this.captionEl)):(n=i.DOM.height(this.settings.target)-i.DOM.height(this.toolbarEl),o=0),e=i.DOM.width(this.settings.target)),i.DOM.setStyle(this.toolbarEl,{top:n+"px",width:e}),i.DOM.setStyle(this.captionEl,{top:o+"px",width:e})},toggleVisibility:function(t){this.isVisible?this.fadeOut():this.show(t)},show:function(t){i.Animation.stop(this.toolbarEl),i.Animation.stop(this.captionEl),this.resetPosition(),this.setToolbarStatus(t),i.Events.fire(this,{type:n.Toolbar.EventTypes.onBeforeShow,target:this}),this.showToolbar(),this.setCaption(t),this.showCaption(),this.isVisible=!0,this.setTimeout(),i.Events.fire(this,{type:n.Toolbar.EventTypes.onShow,target:this})},setTimeout:function(){this.settings.captionAndToolbarAutoHideDelay>0&&(this.clearTimeout(),this.timeout=t.setTimeout(this.fadeOut.bind(this),this.settings.captionAndToolbarAutoHideDelay))},clearTimeout:function(){i.isNothing(this.timeout)||(t.clearTimeout(this.timeout),this.timeout=null)},fadeOut:function(){this.clearTimeout(),i.Events.fire(this,{type:n.Toolbar.EventTypes.onBeforeHide,target:this}),i.Animation.fadeOut(this.toolbarEl,this.settings.fadeOutSpeed),i.Animation.fadeOut(this.captionEl,this.settings.fadeOutSpeed,this.fadeOutHandler),this.isVisible=!1},addEventHandlers:function(){i.Browser.isTouchSupported&&(i.Browser.blackberry||i.Events.add(this.toolbarEl,"touchstart",this.touchStartHandler),i.Events.add(this.toolbarEl,"touchmove",this.touchMoveHandler),i.Events.add(this.captionEl,"touchmove",this.touchMoveHandler)),i.Events.add(this.toolbarEl,"click",this.clickHandler)},removeEventHandlers:function(){i.Browser.isTouchSupported&&(i.Browser.blackberry||i.Events.remove(this.toolbarEl,"touchstart",this.touchStartHandler),i.Events.remove(this.toolbarEl,"touchmove",this.touchMoveHandler),i.Events.remove(this.captionEl,"touchmove",this.touchMoveHandler)),i.Events.remove(this.toolbarEl,"click",this.clickHandler)},handleTap:function(t){this.clearTimeout();var e;t.target===this.nextEl||i.DOM.isChildOf(t.target,this.nextEl)?e=n.Toolbar.ToolbarAction.next:t.target===this.previousEl||i.DOM.isChildOf(t.target,this.previousEl)?e=n.Toolbar.ToolbarAction.previous:t.target===this.closeEl||i.DOM.isChildOf(t.target,this.closeEl)?e=n.Toolbar.ToolbarAction.close:(t.target===this.playEl||i.DOM.isChildOf(t.target,this.playEl))&&(e=n.Toolbar.ToolbarAction.play),this.setTimeout(),i.isNothing(e)&&(e=n.Toolbar.ToolbarAction.none),i.Events.fire(this,{type:n.Toolbar.EventTypes.onTap,target:this,action:e,tapTarget:t.target})},setCaption:function(t){i.DOM.removeChildren(this.captionContentEl),this.currentCaption=i.coalesce(this.cache.images[t].caption,""),i.isObject(this.currentCaption)?i.DOM.appendChild(this.currentCaption,this.captionContentEl):(""===this.currentCaption&&(this.currentCaption=""),i.DOM.appendText(this.currentCaption,this.captionContentEl)),this.currentCaption=""===this.currentCaption?"":this.currentCaption,this.resetPosition()},showToolbar:function(){i.DOM.setStyle(this.toolbarEl,{opacity:this.settings.captionAndToolbarOpacity}),i.DOM.show(this.toolbarEl)},showCaption:function(){return(""===this.currentCaption||this.captionContentEl.childNodes.length<1)&&!this.settings.captionAndToolbarShowEmptyCaptions?(i.DOM.hide(this.captionEl),void 0):(i.DOM.setStyle(this.captionEl,{opacity:this.settings.captionAndToolbarOpacity}),i.DOM.show(this.captionEl),void 0)},setToolbarStatus:function(t){this.settings.loop||(i.DOM.removeClass(this.previousEl,n.Toolbar.CssClasses.previousDisabled),i.DOM.removeClass(this.nextEl,n.Toolbar.CssClasses.nextDisabled),t>0&&t<this.cache.images.length-1||(0===t&&(i.isNothing(this.previousEl)||i.DOM.addClass(this.previousEl,n.Toolbar.CssClasses.previousDisabled)),t===this.cache.images.length-1&&(i.isNothing(this.nextEl)||i.DOM.addClass(this.nextEl,n.Toolbar.CssClasses.nextDisabled))))},onFadeOut:function(){i.DOM.hide(this.toolbarEl),i.DOM.hide(this.captionEl),i.Events.fire(this,{type:n.Toolbar.EventTypes.onHide,target:this})},onTouchStart:function(t){t.preventDefault(),i.Events.remove(this.toolbarEl,"click",this.clickHandler),this.handleTap(t)},onTouchMove:function(t){t.preventDefault()},onClick:function(t){t.preventDefault(),this.handleTap(t)}})}(window,window.klass,window.Code.Util),// Copyright (c) 2012 by Code Computerlove (http://www.codecomputerlove.com)
function(t,e,i){i.registerNamespace("Code.PhotoSwipe.UILayer");var n=t.Code.PhotoSwipe;n.UILayer.CssClasses={uiLayer:"ps-uilayer"}}(window,window.klass,window.Code.Util),// Copyright (c) 2012 by Code Computerlove (http://www.codecomputerlove.com)
function(t,e,i){i.registerNamespace("Code.PhotoSwipe.UILayer");var n=t.Code.PhotoSwipe;n.UILayer.UILayerClass=i.TouchElement.TouchElementClass.extend({el:null,settings:null,dispose:function(){var t;this.removeEventHandlers(),i.DOM.removeChild(this.el,this.el.parentNode);for(t in this)i.objectHasProperty(this,t)&&(this[t]=null)},initialize:function(e){this.settings=e,this.el=i.DOM.createElement("div",{"class":n.UILayer.CssClasses.uiLayer},""),i.DOM.setStyle(this.el,{display:"block",position:"absolute",left:0,top:0,overflow:"hidden",zIndex:this.settings.zIndex,opacity:0}),i.DOM.hide(this.el),this.settings.target===t?i.DOM.appendToBody(this.el):i.DOM.appendChild(this.el,this.settings.target),this.supr(this.el,{swipe:!0,move:!0,gesture:i.Browser.iOS,doubleTap:!0,preventDefaultTouchEvents:this.settings.preventDefaultTouchEvents})},resetPosition:function(){this.settings.target===t?i.DOM.setStyle(this.el,{top:i.DOM.windowScrollTop()+"px",width:i.DOM.windowWidth(),height:i.DOM.windowHeight()}):i.DOM.setStyle(this.el,{top:"0px",width:i.DOM.width(this.settings.target),height:i.DOM.height(this.settings.target)})},show:function(){this.resetPosition(),i.DOM.show(this.el),this.addEventHandlers()},addEventHandlers:function(){this.supr()},removeEventHandlers:function(){this.supr()}})}(window,window.klass,window.Code.Util),// Copyright (c) 2012 by Code Computerlove (http://www.codecomputerlove.com)
function(t,e,i){i.registerNamespace("Code.PhotoSwipe.ZoomPanRotate");var n=t.Code.PhotoSwipe;n.ZoomPanRotate.CssClasses={zoomPanRotate:"ps-zoom-pan-rotate"},n.ZoomPanRotate.EventTypes={onTransform:"PhotoSwipeZoomPanRotateOnTransform"}}(window,window.klass,window.Code.Util),// Copyright (c) 2012 by Code Computerlove (http://www.codecomputerlove.com)
function(t,e,i){i.registerNamespace("Code.PhotoSwipe.ZoomPanRotate");var n=t.Code.PhotoSwipe;n.ZoomPanRotate.ZoomPanRotateClass=e({el:null,settings:null,containerEl:null,imageEl:null,transformSettings:null,panStartingPoint:null,transformEl:null,dispose:function(){var t;i.DOM.removeChild(this.el,this.el.parentNode);for(t in this)i.objectHasProperty(this,t)&&(this[t]=null)},initialize:function(e,o,s){var a,r,l,h;this.settings=e,this.settings.target===t?(a=document.body,r=i.DOM.windowWidth(),l=i.DOM.windowHeight(),h=i.DOM.windowScrollTop()+"px"):(a=this.settings.target,r=i.DOM.width(a),l=i.DOM.height(a),h="0px"),this.imageEl=o.imageEl.cloneNode(!1),i.DOM.setStyle(this.imageEl,{zIndex:1}),this.transformSettings={startingScale:1,scale:1,startingRotation:0,rotation:0,startingTranslateX:0,startingTranslateY:0,translateX:0,translateY:0},this.el=i.DOM.createElement("div",{"class":n.ZoomPanRotate.CssClasses.zoomPanRotate},""),i.DOM.setStyle(this.el,{left:0,top:h,position:"absolute",width:r,height:l,zIndex:this.settings.zIndex,display:"block"}),i.DOM.insertBefore(this.el,s.el,a),i.Browser.iOS?(this.containerEl=i.DOM.createElement("div","",""),i.DOM.setStyle(this.containerEl,{left:0,top:0,width:r,height:l,position:"absolute",zIndex:1}),i.DOM.appendChild(this.imageEl,this.containerEl),i.DOM.appendChild(this.containerEl,this.el),i.Animation.resetTranslate(this.containerEl),i.Animation.resetTranslate(this.imageEl),this.transformEl=this.containerEl):(i.DOM.appendChild(this.imageEl,this.el),this.transformEl=this.imageEl)},setStartingTranslateFromCurrentTransform:function(){var e,n=i.coalesce(this.transformEl.style.webkitTransform,this.transformEl.style.MozTransform,this.transformEl.style.transform);i.isNothing(n)||(e=n.match(/translate\((.*?)\)/),i.isNothing(e)||(e=e[1].split(", "),this.transformSettings.startingTranslateX=t.parseInt(e[0],10),this.transformSettings.startingTranslateY=t.parseInt(e[1],10)))},getScale:function(t){var e=this.transformSettings.startingScale*t;return 0!==this.settings.minUserZoom&&e<this.settings.minUserZoom?e=this.settings.minUserZoom:0!==this.settings.maxUserZoom&&e>this.settings.maxUserZoom&&(e=this.settings.maxUserZoom),e},setStartingScaleAndRotation:function(t,e){this.transformSettings.startingScale=this.getScale(t),this.transformSettings.startingRotation=(this.transformSettings.startingRotation+e)%360},zoomRotate:function(t,e){this.transformSettings.scale=this.getScale(t),this.transformSettings.rotation=this.transformSettings.startingRotation+e,this.applyTransform()},panStart:function(t){this.setStartingTranslateFromCurrentTransform(),this.panStartingPoint={x:t.x,y:t.y}},pan:function(t){var e=t.x-this.panStartingPoint.x,i=t.y-this.panStartingPoint.y,n=e/this.transformSettings.scale,o=i/this.transformSettings.scale;this.transformSettings.translateX=this.transformSettings.startingTranslateX+n,this.transformSettings.translateY=this.transformSettings.startingTranslateY+o,this.applyTransform()},zoomAndPanToPoint:function(e,n){if(this.settings.target===t){this.panStart({x:i.DOM.windowWidth()/2,y:i.DOM.windowHeight()/2});var o=n.x-this.panStartingPoint.x,s=n.y-this.panStartingPoint.y,a=o/this.transformSettings.scale,r=s/this.transformSettings.scale;this.transformSettings.translateX=-1*(this.transformSettings.startingTranslateX+a),this.transformSettings.translateY=-1*(this.transformSettings.startingTranslateY+r)}this.setStartingScaleAndRotation(e,0),this.transformSettings.scale=this.transformSettings.startingScale,this.transformSettings.rotation=0,this.applyTransform()},applyTransform:function(){var e=this.transformSettings.rotation%360,o=t.parseInt(this.transformSettings.translateX,10),s=t.parseInt(this.transformSettings.translateY,10),a="scale("+this.transformSettings.scale+") rotate("+e+"deg) translate("+o+"px, "+s+"px)";i.DOM.setStyle(this.transformEl,{webkitTransform:a,MozTransform:a,msTransform:a,transform:a}),i.Events.fire(this,{target:this,type:n.ZoomPanRotate.EventTypes.onTransform,scale:this.transformSettings.scale,rotation:this.transformSettings.rotation,rotationDegs:e,translateX:o,translateY:s})}})}(window,window.klass,window.Code.Util),// Copyright (c) 2012 by Code Computerlove (http://www.codecomputerlove.com)
function(t,e){e.registerNamespace("Code.PhotoSwipe");var i=t.Code.PhotoSwipe;i.CssClasses={buildingBody:"ps-building",activeBody:"ps-active"},i.EventTypes={onBeforeShow:"PhotoSwipeOnBeforeShow",onShow:"PhotoSwipeOnShow",onBeforeHide:"PhotoSwipeOnBeforeHide",onHide:"PhotoSwipeOnHide",onDisplayImage:"PhotoSwipeOnDisplayImage",onResetPosition:"PhotoSwipeOnResetPosition",onSlideshowStart:"PhotoSwipeOnSlideshowStart",onSlideshowStop:"PhotoSwipeOnSlideshowStop",onTouch:"PhotoSwipeOnTouch",onBeforeCaptionAndToolbarShow:"PhotoSwipeOnBeforeCaptionAndToolbarShow",onCaptionAndToolbarShow:"PhotoSwipeOnCaptionAndToolbarShow",onBeforeCaptionAndToolbarHide:"PhotoSwipeOnBeforeCaptionAndToolbarHide",onCaptionAndToolbarHide:"PhotoSwipeOnCaptionAndToolbarHide",onToolbarTap:"PhotoSwipeOnToolbarTap",onBeforeZoomPanRotateShow:"PhotoSwipeOnBeforeZoomPanRotateShow",onZoomPanRotateShow:"PhotoSwipeOnZoomPanRotateShow",onBeforeZoomPanRotateHide:"PhotoSwipeOnBeforeZoomPanRotateHide",onZoomPanRotateHide:"PhotoSwipeOnZoomPanRotateHide",onZoomPanRotateTransform:"PhotoSwipeOnZoomPanRotateTransform"},i.instances=[],i.activeInstances=[],i.setActivateInstance=function(t){var n=e.arrayIndexOf(t.settings.target,i.activeInstances,"target");if(n>-1)throw"Code.PhotoSwipe.activateInstance: Unable to active instance as another instance is already active for this target";i.activeInstances.push({target:t.settings.target,instance:t})},i.unsetActivateInstance=function(t){var n=e.arrayIndexOf(t,i.activeInstances,"instance");i.activeInstances.splice(n,1)},i.attach=function(t,n,o){var s,a,r,l;for(r=i.createInstance(t,n,o),s=0,a=t.length;a>s;s++)l=t[s],e.isNothing(l.nodeType)||1===l.nodeType&&(l.__photoSwipeClickHandler=i.onTriggerElementClick.bind(r),e.Events.remove(l,"click",l.__photoSwipeClickHandler),e.Events.add(l,"click",l.__photoSwipeClickHandler));return r},t.jQuery&&(t.jQuery.fn.photoSwipe=function(t,e){return i.attach(this,t,e)}),i.detatch=function(t){var n,o,s;for(n=0,o=t.originalImages.length;o>n;n++)s=t.originalImages[n],e.isNothing(s.nodeType)||1===s.nodeType&&(e.Events.remove(s,"click",s.__photoSwipeClickHandler),delete s.__photoSwipeClickHandler);i.disposeInstance(t)},i.createInstance=function(t,n,o){var s;if(e.isNothing(t))throw"Code.PhotoSwipe.attach: No images passed.";if(!e.isLikeArray(t))throw"Code.PhotoSwipe.createInstance: Images must be an array of elements or image urls.";if(t.length<1)throw"Code.PhotoSwipe.createInstance: No images to passed.";if(n=e.coalesce(n,{}),s=i.getInstance(o),!e.isNothing(s))throw'Code.PhotoSwipe.createInstance: Instance with id "'+o+' already exists."';return s=new i.PhotoSwipeClass(t,n,o),i.instances.push(s),s},i.disposeInstance=function(t){var e=i.getInstanceIndex(t);if(0>e)throw"Code.PhotoSwipe.disposeInstance: Unable to find instance to dispose.";t.dispose(),i.instances.splice(e,1),t=null},i.onTriggerElementClick=function(t){t.preventDefault();var e=this;e.show(t.currentTarget)},i.getInstance=function(t){var e,n,o;for(e=0,n=i.instances.length;n>e;e++)if(o=i.instances[e],o.id===t)return o;return null},i.getInstanceIndex=function(t){var e,n,o=-1;for(e=0,n=i.instances.length;n>e;e++)if(i.instances[e]===t){o=e;break}return o}}(window,window.Code.Util),// Copyright (c) 2012 by Code Computerlove (http://www.codecomputerlove.com)
function(t,e,i,n,o,s,a,r,l){i.registerNamespace("Code.PhotoSwipe");var h=t.Code.PhotoSwipe;h.PhotoSwipeClass=e({id:null,settings:null,isBackEventSupported:null,backButtonClicked:null,currentIndex:null,originalImages:null,mouseWheelStartTime:null,windowDimensions:null,cache:null,documentOverlay:null,carousel:null,uiLayer:null,toolbar:null,zoomPanRotate:null,windowOrientationChangeHandler:null,windowScrollHandler:null,windowHashChangeHandler:null,keyDownHandler:null,windowOrientationEventName:null,uiLayerTouchHandler:null,carouselSlideByEndHandler:null,carouselSlideshowStartHandler:null,carouselSlideshowStopHandler:null,toolbarTapHandler:null,toolbarBeforeShowHandler:null,toolbarShowHandler:null,toolbarBeforeHideHandler:null,toolbarHideHandler:null,mouseWheelHandler:null,zoomPanRotateTransformHandler:null,_isResettingPosition:null,_uiWebViewResetPositionTimeout:null,dispose:function(){var t;i.Events.remove(this,h.EventTypes.onBeforeShow),i.Events.remove(this,h.EventTypes.onShow),i.Events.remove(this,h.EventTypes.onBeforeHide),i.Events.remove(this,h.EventTypes.onHide),i.Events.remove(this,h.EventTypes.onDisplayImage),i.Events.remove(this,h.EventTypes.onResetPosition),i.Events.remove(this,h.EventTypes.onSlideshowStart),i.Events.remove(this,h.EventTypes.onSlideshowStop),i.Events.remove(this,h.EventTypes.onTouch),i.Events.remove(this,h.EventTypes.onBeforeCaptionAndToolbarShow),i.Events.remove(this,h.EventTypes.onCaptionAndToolbarShow),i.Events.remove(this,h.EventTypes.onBeforeCaptionAndToolbarHide),i.Events.remove(this,h.EventTypes.onCaptionAndToolbarHide),i.Events.remove(this,h.EventTypes.onZoomPanRotateTransform),this.removeEventHandlers(),i.isNothing(this.documentOverlay)||this.documentOverlay.dispose(),i.isNothing(this.carousel)||this.carousel.dispose(),i.isNothing(this.uiLayer)||this.uiLayer.dispose(),i.isNothing(this.toolbar)||this.toolbar.dispose(),this.destroyZoomPanRotate(),i.isNothing(this.cache)||this.cache.dispose();for(t in this)i.objectHasProperty(this,t)&&(this[t]=null)},initialize:function(e,o,s){var a;this.id=i.isNothing(s)?"PhotoSwipe"+(new Date).getTime().toString():s,this.originalImages=e,i.Browser.android&&!i.Browser.firefox&&t.navigator.userAgent.match(/Android (\d+.\d+)/).toString().replace(/^.*\,/,"")>=2.1&&(this.isBackEventSupported=!0),this.isBackEventSupported||(this.isBackEventSupported=i.objectHasProperty(t,"onhashchange")),this.settings={fadeInSpeed:250,fadeOutSpeed:250,preventHide:!1,preventSlideshow:!1,zIndex:1e3,backButtonHideEnabled:!0,enableKeyboard:!0,enableMouseWheel:!0,mouseWheelSpeed:350,autoStartSlideshow:!1,jQueryMobile:!i.isNothing(t.jQuery)&&!i.isNothing(t.jQuery.mobile),jQueryMobileDialogHash:"&ui-state=dialog",enableUIWebViewRepositionTimeout:!1,uiWebViewResetPositionDelay:500,target:t,preventDefaultTouchEvents:!0,loop:!0,slideSpeed:250,nextPreviousSlideSpeed:0,enableDrag:!0,swipeThreshold:50,swipeTimeThreshold:250,slideTimingFunction:"ease-out",slideshowDelay:3e3,doubleTapSpeed:250,margin:20,imageScaleMethod:"fit",captionAndToolbarHide:!1,captionAndToolbarFlipPosition:!1,captionAndToolbarAutoHideDelay:5e3,captionAndToolbarOpacity:.8,captionAndToolbarShowEmptyCaptions:!0,getToolbar:h.Toolbar.getToolbar,allowUserZoom:!0,allowRotationOnUserZoom:!1,maxUserZoom:5,minUserZoom:.5,doubleTapZoomLevel:2.5,getImageSource:h.Cache.Functions.getImageSource,getImageCaption:h.Cache.Functions.getImageCaption,getImageMetaData:h.Cache.Functions.getImageMetaData,cacheMode:h.Cache.Mode.normal},i.extend(this.settings,o),this.settings.target!==t&&(a=i.DOM.getStyle(this.settings.target,"position"),("relative"!==a||"absolute"!==a)&&i.DOM.setStyle(this.settings.target,"position","relative")),this.settings.target!==t?(this.isBackEventSupported=!1,this.settings.backButtonHideEnabled=!1):this.settings.preventHide&&(this.settings.backButtonHideEnabled=!1),this.cache=new n.CacheClass(e,this.settings)},show:function(e){var n,o;if(this._isResettingPosition=!1,this.backButtonClicked=!1,i.isNumber(e))this.currentIndex=e;else for(this.currentIndex=-1,n=0,o=this.originalImages.length;o>n;n++)if(this.originalImages[n]===e){this.currentIndex=n;break}if(this.currentIndex<0||this.currentIndex>this.originalImages.length-1)throw"Code.PhotoSwipe.PhotoSwipeClass.show: Starting index out of range";this.isAlreadyGettingPage=this.getWindowDimensions(),h.setActivateInstance(this),this.windowDimensions=this.getWindowDimensions(),this.settings.target===t?i.DOM.addClass(t.document.body,h.CssClasses.buildingBody):i.DOM.addClass(this.settings.target,h.CssClasses.buildingBody),this.createComponents(),i.Events.fire(this,{type:h.EventTypes.onBeforeShow,target:this}),this.documentOverlay.fadeIn(this.settings.fadeInSpeed,this.onDocumentOverlayFadeIn.bind(this))},getWindowDimensions:function(){return{width:i.DOM.windowWidth(),height:i.DOM.windowHeight()}},createComponents:function(){this.documentOverlay=new o.DocumentOverlayClass(this.settings),this.carousel=new s.CarouselClass(this.cache,this.settings),this.uiLayer=new r.UILayerClass(this.settings),this.settings.captionAndToolbarHide||(this.toolbar=new a.ToolbarClass(this.cache,this.settings))},resetPosition:function(){if(!this._isResettingPosition){var t=this.getWindowDimensions();(i.isNothing(this.windowDimensions)||t.width!==this.windowDimensions.width||t.height!==this.windowDimensions.height)&&(this._isResettingPosition=!0,this.windowDimensions=t,this.destroyZoomPanRotate(),this.documentOverlay.resetPosition(),this.carousel.resetPosition(),i.isNothing(this.toolbar)||this.toolbar.resetPosition(),this.uiLayer.resetPosition(),this._isResettingPosition=!1,i.Events.fire(this,{type:h.EventTypes.onResetPosition,target:this}))}},addEventHandler:function(t,e){i.Events.add(this,t,e)},addEventHandlers:function(){if(i.isNothing(this.windowOrientationChangeHandler)&&(this.windowOrientationChangeHandler=this.onWindowOrientationChange.bind(this),this.windowScrollHandler=this.onWindowScroll.bind(this),this.keyDownHandler=this.onKeyDown.bind(this),this.windowHashChangeHandler=this.onWindowHashChange.bind(this),this.uiLayerTouchHandler=this.onUILayerTouch.bind(this),this.carouselSlideByEndHandler=this.onCarouselSlideByEnd.bind(this),this.carouselSlideshowStartHandler=this.onCarouselSlideshowStart.bind(this),this.carouselSlideshowStopHandler=this.onCarouselSlideshowStop.bind(this),this.toolbarTapHandler=this.onToolbarTap.bind(this),this.toolbarBeforeShowHandler=this.onToolbarBeforeShow.bind(this),this.toolbarShowHandler=this.onToolbarShow.bind(this),this.toolbarBeforeHideHandler=this.onToolbarBeforeHide.bind(this),this.toolbarHideHandler=this.onToolbarHide.bind(this),this.mouseWheelHandler=this.onMouseWheel.bind(this),this.zoomPanRotateTransformHandler=this.onZoomPanRotateTransform.bind(this)),i.Browser.android)this.orientationEventName="resize";else if(i.Browser.iOS&&!i.Browser.safari)i.Events.add(t.document.body,"orientationchange",this.windowOrientationChangeHandler);else{var e=!i.isNothing(t.onorientationchange);this.orientationEventName=e?"orientationchange":"resize"}i.isNothing(this.orientationEventName)||i.Events.add(t,this.orientationEventName,this.windowOrientationChangeHandler),this.settings.target===t&&i.Events.add(t,"scroll",this.windowScrollHandler),this.settings.enableKeyboard&&i.Events.add(t.document,"keydown",this.keyDownHandler),this.isBackEventSupported&&this.settings.backButtonHideEnabled&&(this.windowHashChangeHandler=this.onWindowHashChange.bind(this),this.settings.jQueryMobile?t.location.hash=this.settings.jQueryMobileDialogHash:(this.currentHistoryHashValue="PhotoSwipe"+(new Date).getTime().toString(),t.location.hash=this.currentHistoryHashValue),i.Events.add(t,"hashchange",this.windowHashChangeHandler)),this.settings.enableMouseWheel&&i.Events.add(t,"mousewheel",this.mouseWheelHandler),i.Events.add(this.uiLayer,i.TouchElement.EventTypes.onTouch,this.uiLayerTouchHandler),i.Events.add(this.carousel,s.EventTypes.onSlideByEnd,this.carouselSlideByEndHandler),i.Events.add(this.carousel,s.EventTypes.onSlideshowStart,this.carouselSlideshowStartHandler),i.Events.add(this.carousel,s.EventTypes.onSlideshowStop,this.carouselSlideshowStopHandler),i.isNothing(this.toolbar)||(i.Events.add(this.toolbar,a.EventTypes.onTap,this.toolbarTapHandler),i.Events.add(this.toolbar,a.EventTypes.onBeforeShow,this.toolbarBeforeShowHandler),i.Events.add(this.toolbar,a.EventTypes.onShow,this.toolbarShowHandler),i.Events.add(this.toolbar,a.EventTypes.onBeforeHide,this.toolbarBeforeHideHandler),i.Events.add(this.toolbar,a.EventTypes.onHide,this.toolbarHideHandler))},removeEventHandlers:function(){i.Browser.iOS&&!i.Browser.safari&&i.Events.remove(t.document.body,"orientationchange",this.windowOrientationChangeHandler),i.isNothing(this.orientationEventName)||i.Events.remove(t,this.orientationEventName,this.windowOrientationChangeHandler),i.Events.remove(t,"scroll",this.windowScrollHandler),this.settings.enableKeyboard&&i.Events.remove(t.document,"keydown",this.keyDownHandler),this.isBackEventSupported&&this.settings.backButtonHideEnabled&&i.Events.remove(t,"hashchange",this.windowHashChangeHandler),this.settings.enableMouseWheel&&i.Events.remove(t,"mousewheel",this.mouseWheelHandler),i.isNothing(this.uiLayer)||i.Events.remove(this.uiLayer,i.TouchElement.EventTypes.onTouch,this.uiLayerTouchHandler),i.isNothing(this.toolbar)||(i.Events.remove(this.carousel,s.EventTypes.onSlideByEnd,this.carouselSlideByEndHandler),i.Events.remove(this.carousel,s.EventTypes.onSlideshowStart,this.carouselSlideshowStartHandler),i.Events.remove(this.carousel,s.EventTypes.onSlideshowStop,this.carouselSlideshowStopHandler)),i.isNothing(this.toolbar)||(i.Events.remove(this.toolbar,a.EventTypes.onTap,this.toolbarTapHandler),i.Events.remove(this.toolbar,a.EventTypes.onBeforeShow,this.toolbarBeforeShowHandler),i.Events.remove(this.toolbar,a.EventTypes.onShow,this.toolbarShowHandler),i.Events.remove(this.toolbar,a.EventTypes.onBeforeHide,this.toolbarBeforeHideHandler),i.Events.remove(this.toolbar,a.EventTypes.onHide,this.toolbarHideHandler))},hide:function(){if(!this.settings.preventHide){if(i.isNothing(this.documentOverlay))throw"Code.PhotoSwipe.PhotoSwipeClass.hide: PhotoSwipe instance is already hidden";i.isNothing(this.hiding)&&(this.clearUIWebViewResetPositionTimeout(),this.destroyZoomPanRotate(),this.removeEventHandlers(),i.Events.fire(this,{type:h.EventTypes.onBeforeHide,target:this}),this.uiLayer.dispose(),this.uiLayer=null,i.isNothing(this.toolbar)||(this.toolbar.dispose(),this.toolbar=null),this.carousel.dispose(),this.carousel=null,i.DOM.removeClass(t.document.body,h.CssClasses.activeBody),this.documentOverlay.dispose(),this.documentOverlay=null,this._isResettingPosition=!1,h.unsetActivateInstance(this),i.Events.fire(this,{type:h.EventTypes.onHide,target:this}),this.goBackInHistory())}},goBackInHistory:function(){this.isBackEventSupported&&this.settings.backButtonHideEnabled&&(this.backButtonClicked||t.history.back())},play:function(){this.isZoomActive()||this.settings.preventSlideshow||i.isNothing(this.carousel)||(!i.isNothing(this.toolbar)&&this.toolbar.isVisible&&this.toolbar.fadeOut(),this.carousel.startSlideshow())},stop:function(){this.isZoomActive()||i.isNothing(this.carousel)||this.carousel.stopSlideshow()},previous:function(){this.isZoomActive()||i.isNothing(this.carousel)||this.carousel.previous()},next:function(){this.isZoomActive()||i.isNothing(this.carousel)||this.carousel.next()},toggleToolbar:function(){this.isZoomActive()||i.isNothing(this.toolbar)||this.toolbar.toggleVisibility(this.currentIndex)},fadeOutToolbarIfVisible:function(){!i.isNothing(this.toolbar)&&this.toolbar.isVisible&&this.settings.captionAndToolbarAutoHideDelay>0&&this.toolbar.fadeOut()},createZoomPanRotate:function(){this.stop(),this.canUserZoom()&&!this.isZoomActive()&&(i.Events.fire(this,h.EventTypes.onBeforeZoomPanRotateShow),this.zoomPanRotate=new l.ZoomPanRotateClass(this.settings,this.cache.images[this.currentIndex],this.uiLayer),this.uiLayer.captureSettings.preventDefaultTouchEvents=!0,i.Events.add(this.zoomPanRotate,h.ZoomPanRotate.EventTypes.onTransform,this.zoomPanRotateTransformHandler),i.Events.fire(this,h.EventTypes.onZoomPanRotateShow),!i.isNothing(this.toolbar)&&this.toolbar.isVisible&&this.toolbar.fadeOut())},destroyZoomPanRotate:function(){i.isNothing(this.zoomPanRotate)||(i.Events.fire(this,h.EventTypes.onBeforeZoomPanRotateHide),i.Events.remove(this.zoomPanRotate,h.ZoomPanRotate.EventTypes.onTransform,this.zoomPanRotateTransformHandler),this.zoomPanRotate.dispose(),this.zoomPanRotate=null,this.uiLayer.captureSettings.preventDefaultTouchEvents=this.settings.preventDefaultTouchEvents,i.Events.fire(this,h.EventTypes.onZoomPanRotateHide))},canUserZoom:function(){var t,e;if(i.Browser.msie){if(t=document.createElement("div"),i.isNothing(t.style.msTransform))return!1}else if(!i.Browser.isCSSTransformSupported)return!1;return this.settings.allowUserZoom?this.carousel.isSliding?!1:(e=this.cache.images[this.currentIndex],i.isNothing(e)?!1:e.isLoading?!1:!0):!1},isZoomActive:function(){return!i.isNothing(this.zoomPanRotate)},getCurrentImage:function(){return this.cache.images[this.currentIndex]},onDocumentOverlayFadeIn:function(){t.setTimeout(function(){var e=this.settings.target===t?t.document.body:this.settings.target;i.DOM.removeClass(e,h.CssClasses.buildingBody),i.DOM.addClass(e,h.CssClasses.activeBody),this.addEventHandlers(),this.carousel.show(this.currentIndex),this.uiLayer.show(),this.settings.autoStartSlideshow?this.play():i.isNothing(this.toolbar)||this.toolbar.show(this.currentIndex),i.Events.fire(this,{type:h.EventTypes.onShow,target:this}),this.setUIWebViewResetPositionTimeout()}.bind(this),250)},setUIWebViewResetPositionTimeout:function(){this.settings.enableUIWebViewRepositionTimeout&&i.Browser.iOS&&!i.Browser.safari&&(i.isNothing(this._uiWebViewResetPositionTimeout)||t.clearTimeout(this._uiWebViewResetPositionTimeout),this._uiWebViewResetPositionTimeout=t.setTimeout(function(){this.resetPosition(),this.setUIWebViewResetPositionTimeout()}.bind(this),this.settings.uiWebViewResetPositionDelay))},clearUIWebViewResetPositionTimeout:function(){i.isNothing(this._uiWebViewResetPositionTimeout)||t.clearTimeout(this._uiWebViewResetPositionTimeout)},onWindowScroll:function(){this.resetPosition()},onWindowOrientationChange:function(){this.resetPosition()},onWindowHashChange:function(){var e="#"+(this.settings.jQueryMobile?this.settings.jQueryMobileDialogHash:this.currentHistoryHashValue);t.location.hash!==e&&(this.backButtonClicked=!0,this.hide())},onKeyDown:function(t){37===t.keyCode?(t.preventDefault(),this.previous()):39===t.keyCode?(t.preventDefault(),this.next()):38===t.keyCode||40===t.keyCode?t.preventDefault():27===t.keyCode?(t.preventDefault(),this.hide()):32===t.keyCode?(this.settings.hideToolbar?this.hide():this.toggleToolbar(),t.preventDefault()):13===t.keyCode&&(t.preventDefault(),this.play())},onUILayerTouch:function(e){if(this.isZoomActive())switch(e.action){case i.TouchElement.ActionTypes.gestureChange:this.zoomPanRotate.zoomRotate(e.scale,this.settings.allowRotationOnUserZoom?e.rotation:0);break;case i.TouchElement.ActionTypes.gestureEnd:this.zoomPanRotate.setStartingScaleAndRotation(e.scale,this.settings.allowRotationOnUserZoom?e.rotation:0);break;case i.TouchElement.ActionTypes.touchStart:this.zoomPanRotate.panStart(e.point);break;case i.TouchElement.ActionTypes.touchMove:this.zoomPanRotate.pan(e.point);break;case i.TouchElement.ActionTypes.doubleTap:this.destroyZoomPanRotate(),this.toggleToolbar();break;case i.TouchElement.ActionTypes.swipeLeft:this.destroyZoomPanRotate(),this.next(),this.toggleToolbar();break;case i.TouchElement.ActionTypes.swipeRight:this.destroyZoomPanRotate(),this.previous(),this.toggleToolbar()}else switch(e.action){case i.TouchElement.ActionTypes.touchMove:case i.TouchElement.ActionTypes.swipeLeft:case i.TouchElement.ActionTypes.swipeRight:this.fadeOutToolbarIfVisible(),this.carousel.onTouch(e.action,e.point);break;case i.TouchElement.ActionTypes.touchStart:case i.TouchElement.ActionTypes.touchMoveEnd:this.carousel.onTouch(e.action,e.point);break;case i.TouchElement.ActionTypes.tap:this.toggleToolbar();break;case i.TouchElement.ActionTypes.doubleTap:this.settings.target===t&&(e.point.x-=i.DOM.windowScrollLeft(),e.point.y-=i.DOM.windowScrollTop());var n=this.cache.images[this.currentIndex].imageEl,o=t.parseInt(i.DOM.getStyle(n,"top"),10),s=t.parseInt(i.DOM.getStyle(n,"left"),10),a=s+i.DOM.width(n),r=o+i.DOM.height(n);e.point.x<s?e.point.x=s:e.point.x>a&&(e.point.x=a),e.point.y<o?e.point.y=o:e.point.y>r&&(e.point.y=r),this.createZoomPanRotate(),this.isZoomActive()&&this.zoomPanRotate.zoomAndPanToPoint(this.settings.doubleTapZoomLevel,e.point);break;case i.TouchElement.ActionTypes.gestureStart:this.createZoomPanRotate()}i.Events.fire(this,{type:h.EventTypes.onTouch,target:this,point:e.point,action:e.action})},onCarouselSlideByEnd:function(t){this.currentIndex=t.cacheIndex,i.isNothing(this.toolbar)||(this.toolbar.setCaption(this.currentIndex),this.toolbar.setToolbarStatus(this.currentIndex)),i.Events.fire(this,{type:h.EventTypes.onDisplayImage,target:this,action:t.action,index:t.cacheIndex})},onToolbarTap:function(t){switch(t.action){case a.ToolbarAction.next:this.next();break;case a.ToolbarAction.previous:this.previous();break;case a.ToolbarAction.close:this.hide();break;case a.ToolbarAction.play:this.play()}i.Events.fire(this,{type:h.EventTypes.onToolbarTap,target:this,toolbarAction:t.action,tapTarget:t.tapTarget})},onMouseWheel:function(t){var e=i.Events.getWheelDelta(t),n=t.timeStamp-(this.mouseWheelStartTime||0);n<this.settings.mouseWheelSpeed||(this.mouseWheelStartTime=t.timeStamp,this.settings.invertMouseWheel&&(e=-1*e),0>e?this.next():e>0&&this.previous())},onCarouselSlideshowStart:function(){i.Events.fire(this,{type:h.EventTypes.onSlideshowStart,target:this})},onCarouselSlideshowStop:function(){i.Events.fire(this,{type:h.EventTypes.onSlideshowStop,target:this})},onToolbarBeforeShow:function(){i.Events.fire(this,{type:h.EventTypes.onBeforeCaptionAndToolbarShow,target:this})},onToolbarShow:function(){i.Events.fire(this,{type:h.EventTypes.onCaptionAndToolbarShow,target:this})},onToolbarBeforeHide:function(){i.Events.fire(this,{type:h.EventTypes.onBeforeCaptionAndToolbarHide,target:this})},onToolbarHide:function(){i.Events.fire(this,{type:h.EventTypes.onCaptionAndToolbarHide,target:this})},onZoomPanRotateTransform:function(t){i.Events.fire(this,{target:this,type:h.EventTypes.onZoomPanRotateTransform,scale:t.scale,rotation:t.rotation,rotationDegs:t.rotationDegs,translateX:t.translateX,translateY:t.translateY})}})}(window,window.klass,window.Code.Util,window.Code.PhotoSwipe.Cache,window.Code.PhotoSwipe.DocumentOverlay,window.Code.PhotoSwipe.Carousel,window.Code.PhotoSwipe.Toolbar,window.Code.PhotoSwipe.UILayer,window.Code.PhotoSwipe.ZoomPanRotate),function(t,e){e(document).ready(function(){if(e(".photoswipe").length>0){var t={};e(".photoswipe a").photoSwipe(t)}})}(window,window.jQuery,window.Code.PhotoSwipe),$(document).ready(function(){rescale=function(){var e=window.orientation,i="portrait"===e,n=i?480:320,o=i?screen.availHeight:screen.availWidth,s=Math.max(n,$(window).height()),a=Math.min(o,s),r=($("body"),$("#wrapper-wide-body")),l=$("header").outerHeight()+$("footer").outerHeight()+t.h;a>l?r.css({"padding-top":Math.abs((l-a)/2)}):r.css({"padding-top":0})},init=function(){"undefined"!=typeof data&&(Galleria.addTheme({name:"classic",author:"Jouf Design",defaults:{transition:"slide",thumbCrop:"height"},init:function(t){this.addElement("info-link","info-close","thumbnails-tab","controls-container","controls-play"),this.append({info:["info-link","info-close"],container:["controls-container","thumbnails-tab"],"controls-container":["controls-play"]});var e=(this.$("info-link,info-close,info-text"),this.$("stage"),this.$("controls-play")),i=this.$("thumbnails-tab"),n=this.$("thumbnails-container"),o=(this.$("thumbnails-hover"),Galleria.TOUCH),s=!0,a=o?"touchstart":"click",r=function(t){t?n.css("opacity",100):n.css("opacity",0),s=t};r(!1),o||(this.addIdleState(this.get("counter"),{opacity:1}),this.bind(Galleria.IDLE_ENTER,function(){}),this.bind(Galleria.IDLE_EXIT,function(){})),t.autoplay===!0&&e.removeClass("player-ui-icon-play").addClass("player-ui-icon-pause"),t._toggleInfo===!0,this.bind(Galleria.IMAGE,function(){}),this.bind(Galleria.THUMBNAIL,function(t){o?$(t.thumbTarget).css("opacity",this.getIndex()?1:.6):($(t.thumbTarget).css("opacity",.6).parent().hover(function(){$(this).not(".active").children().stop().fadeTo(100,1)},function(){$(this).not(".active").children().stop().fadeTo(400,.6)}),t.index===this.getIndex()&&$(t.thumbTarget).css("opacity",1))}),n.bind("mouseover",this.proxy(function(){r(!0)})),n.bind("mouseout",this.proxy(function(){r(!1)})),i.bind(t.thumbEventType,this.proxy(function(){i.toggleClass("open",!s),r(!s)})),e.bind(a,this.proxy(function(){this._playing?this.pause():(this.next(),this.play())})),this.bind(Galleria.PAUSE,function(){e.removeClass("player-ui-icon-pause").addClass("player-ui-icon-play")}),this.bind(Galleria.PLAY,function(){e.removeClass("player-ui-icon-play").addClass("player-ui-icon-pause")}),this.bind(Galleria.LOADSTART,function(t){t.cached||this.$("loader").show().fadeTo(200,.4),$(t.thumbTarget).css("opacity",1).parent().siblings().children().css("opacity",.6)}),this.bind(Galleria.LOADFINISH,function(){this.$("loader").fadeOut(200)}),this.bind(Galleria.FULLSCREEN_ENTER,function(){$("#wrapper-wide-header").css("visibility","hidden"),$("#wrapper-wide-footer").css("visibility","hidden"),$("body").css("backgroundColor","#000000")}),this.bind(Galleria.FULLSCREEN_EXIT,function(){Utils.forceStyles(self.get("container"),{position:"relative"}),$("#wrapper-wide-header").css("visibility","visible"),$("#wrapper-wide-footer").css("visibility","visible"),$("body").css("backgroundColor","#ffffff")})}}),Galleria.run(".galleria",{width:t.w,height:t.h,imageTimeout:4e4,autoplay:!1,debug:!1,preload:4,queue:!0,showInfo:!1,showCounter:!0,useCanvas:!1,fullscreenDoubleTap:!1,idleTime:1e3,dataSource:data})),"album"==$("body").attr("id")&&($(".description.albums:first").hide(),$(".next-previous").hide()),$("#primary-menu ul.nav > li:even a").css("color","#67CCE6"),$("#primary-menu ul.dropdown-menu a").css("color","#67CCE6"),$(".galleria").noContext(),$(window).bind("throttledresize",function(t){rescale(t)}),rescale()};var t={w:882,h:648};init()});